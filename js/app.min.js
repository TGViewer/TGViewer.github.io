var App={name:"TGViewer",useProxy:!1,viewType:"list",step:6,channels:[],currentChannel:{}},renderModalDialogSettingsBMD=!1,isOldBrowser=!1,domainOriginal="t.me/",domainSecond="tele.click/";function getRandomMessage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=Math.floor(Math.random()*(App.currentChannel.max-App.currentChannel.min+1))+App.currentChannel.min)}function getStartMessage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=getNumberValue($("#rangeMessage").val()))}function setRangeMessage(){if(!$.isEmptyObject(App.currentChannel)){var e=$("#rangeMessage")[0];e.step=App.step,e.min=App.currentChannel.min,e.max=App.currentChannel.max,e.value=App.currentChannel.value}}function searchElementIndexInArray(e,n,a){for(var t=-1,l=e,i=0;i<l.length;i++){var r=l[i];if(r.hasOwnProperty(a)&&r[a].toLowerCase()===n.toLowerCase())return t=i}return t}function imgLoaded(e){$(e).parent().addClass("loaded")}function lazyLoad(){$(".lazy_load").each(function(){var e=$(this);""!=e.attr("data-src")&&e.on("load",imgLoaded(e[0])).attr("src",e.attr("data-src")).attr("data-src","")})}function renderLogoApp(e){if($.isEmptyObject(App.currentChannel)){var n=App.name;$(e).html('<img class="d-inline-block align-top rounded-circle" src="ico/favicon-32x32.png" width="32" height="32" title="'+n+'" alt="'+n+'"><span class="logo-app">'+n+"</span>")}else if(""!=App.currentChannel.image){var a=App.currentChannel.title||App.currentChannel.name;$(e).html('<img class="d-inline-block align-top rounded-circle my-empty-image" src="'+App.currentChannel.image+'" width="32" height="32" title="'+a+'" alt="" onload="this.alt=\''+a+'\';"><span class="logo-app">'+a+"</span>")}else{var t=App.currentChannel.name;$(e).html('<span class="letter-circle" title="'+t+'">'+t.substr(0,2).toUpperCase()+'</span><span class="logo-app">'+t+"</span>")}}function renderListChannel(){if(0<App.channels.length){var e="";e+='<h6 class="dropdown-header">Select channel</h6>';for(var n=0;n<App.channels.length;n++){var a=App.channels[n].name,t=App.channels[n].title||a,l=App.channels[n].image;e+=""!=l?'<button class="dropdown-item list-channel-item" type="button"><img class="d-inline-block align-top rounded-circle logo-channel-img channel-item my-empty-image lazy_load" src="" data-src="'+l+'" width="32" height="32" data-name="'+a+'" title="'+t+'" alt="" onload="this.alt=\''+t+'\';"><span class="name-channel">'+t+"</span></button>":'<button class="dropdown-item list-channel-item" type="button"><span class="letter-circle logo-channel channel-item" data-name="'+a+'" title="'+a+'">'+a.substr(0,2).toUpperCase()+'</span><span class="name-channel">'+a+"</span></button>"}if($("#listChannel").html(e),""!=e)lazyLoad(),$(".list-channel-item").click(function(e){var n=$(this).find(".channel-item").attr("data-name");App.currentChannel=App.channels[searchElementIndexInArray(App.channels,n,"name")];var a=App.currentChannel;try{""!=a.image&&""!=a.title&&0!=a.lastUpdate||getCurrentChannelInfo(a.name)}catch(e){my_ga("send","event","selectChannel: "+n,"error","getCurrentChannelInfo")}renderLogoApp("#logoApp"),toggleDeleteChannel(),setRangeMessage(),getPage(),my_ga("send","event","selectChannel: "+n,"click","listChannelItem")})}else $("#listChannel").html('<h6 class="dropdown-header">Add channels to select</h6>');toggleDeleteChannel()}function toggleDeleteChannel(){$.isEmptyObject(App.currentChannel)?$("#deleteChannel").html(""):(420<$(window).width()?$("#deleteChannel").html('<button id="btnDeleteChannel" type="button" class="btn bmd-btn-icon" title="Delete current channel"><i class="material-icons">delete</i></button>'):$("#deleteChannel").html('<button id="btnDeleteChannel" type="button" class="dropdown-item"><i class="material-icons my-icon-dropdown">delete</i> Delete channel</button>'),$("#btnDeleteChannel").click(function(e){deleteCurrentChannel(),my_ga("send","event","deleteCurrentChannel","click","btnDeleteChannel")}))}function renderViewType(){420<$(window).width()?"list"==App.viewType?$("#changeViewType").html('<button id="btnViewType" type="button" class="btn bmd-btn-icon" title="Table view"><i class="material-icons">view_module</i></button>'):$("#changeViewType").html('<button id="btnViewType" type="button" class="btn bmd-btn-icon" title="List view"><i class="material-icons">view_list</i></button>'):"list"==App.viewType?$("#changeViewType").html('<button id="btnViewType" type="button" class="dropdown-item"><i class="material-icons my-icon-dropdown">view_module</i> Table view</button><div id="btnViewTypeDivider" class="dropdown-divider"> </div>'):$("#changeViewType").html('<button id="btnViewType" type="button" class="dropdown-item"><i class="material-icons my-icon-dropdown">view_list</i> List view</button><div id="btnViewTypeDivider" class="dropdown-divider"> </div>'),$("#btnViewType").click(function(e){toggleViewType(),my_ga("send","event","toggleViewType: "+App.viewType,"click","btnViewType")})}function toggleViewType(){App.viewType="list"==App.viewType?"table":"list",renderViewType(),getPage()}function deleteCurrentChannel(){$.isEmptyObject(App.currentChannel)||0<App.channels.length&&(App.channels.splice(searchElementIndexInArray(App.channels,App.currentChannel.name,"name"),1),App.currentChannel={},renderLogoApp("#logoApp"),renderListChannel(),getPage())}function addCurrentChannelSettings(e,n,a){var t=e,l=1,i=1e3;n=n||1,a=a||!1,e.toLowerCase()==="SuperDeals".toLowerCase()?(t="SuperDeals",l=51e4,i=574902):e.toLowerCase()==="ThisIsInterestin".toLowerCase()&&(t="ThisIsInterestin",l=237e3,i=239050),1<n?i=n+App.step:n=l;var r={name:t,min:l=i<l?i:l,max:i=i<l?l:i,value:n=i<(n=n<l?l:n)?i:n,title:"",image:"",description:"",descriptionHtml:"",members:0,lastUpdate:0,lastView:0};a?App.channels.push(r):(App.currentChannel=r,getCurrentChannelInfo(App.currentChannel.name))}function p(e,n){e.push(n)}function getCurrentChannelInfo(n){var e=[];p(e,"h"),p(e,"t"),p(e,"t"),p(e,"p"),p(e,"s"),p(e,":"),p(e,"/"),p(e,"/"),p(e,"s"),p(e,"c"),p(e,"r"),p(e,"i"),p(e,"p"),p(e,"t"),p(e,"."),p(e,"g"),p(e,"o"),p(e,"o"),p(e,"g"),p(e,"l"),p(e,"e"),p(e,"."),p(e,"c"),p(e,"o"),p(e,"m"),p(e,"/"),p(e,"m"),p(e,"a"),p(e,"c"),p(e,"r"),p(e,"o"),p(e,"s"),p(e,"/"),p(e,"s"),p(e,"/"),p(e,"A"),p(e,"K"),p(e,"f"),p(e,"y"),p(e,"c"),p(e,"b"),p(e,"x"),p(e,"c"),p(e,"B"),p(e,"Y"),p(e,"e"),p(e,"E"),p(e,"9"),p(e,"E"),p(e,"q"),p(e,"s"),p(e,"9"),p(e,"d"),p(e,"q"),p(e,"p"),p(e,"S"),p(e,"e"),p(e,"B"),p(e,"r"),p(e,"b"),p(e,"4"),p(e,"R"),p(e,"e"),p(e,"2"),p(e,"q"),p(e,"3"),p(e,"w"),p(e,"T"),p(e,"j"),p(e,"o"),p(e,"f"),p(e,"q"),p(e,"1"),p(e,"5"),p(e,"_"),p(e,"b"),p(e,"w"),p(e,"V"),p(e,"i"),p(e,"s"),p(e,"Z"),p(e,"_"),p(e,"4"),p(e,"C"),p(e,"n"),p(e,"5"),p(e,"d"),p(e,"h"),p(e,"j"),p(e,"4"),p(e,"/"),p(e,"e"),p(e,"x"),p(e,"e"),p(e,"c"),p(e,"?"),p(e,"c"),p(e,"h"),p(e,"a"),p(e,"n"),p(e,"n"),p(e,"e"),p(e,"l"),p(e,"=");var a=""+e.join("")+n;$.ajax({url:a,success:function(e){e.result&&(App.currentChannel.title=e.title||n,App.currentChannel.image=e.image,App.currentChannel.description=e.description,App.currentChannel.descriptionHtml=e.descriptionHtml,App.currentChannel.members=e.members,App.currentChannel.lastUpdate=getCurrentDateValue(),getCasheImage(n),renderLogoApp("#logoApp"),renderListChannel(),setAppCashe(),my_ga("send","event","getCurrentChannelInfo: "+n,"function","addCurrentChannelSettings"))}})}function getCurrentDateValue(){return(new Date).valueOf()}function getDateWithValue(e){return new Date(e)}function getSanitizeCurrentChannelParameters(e){var n={},a=1,t="";t=$("<div/>").html(e).text().replace("tg://resolve?domain=","").split("&",1);var l=(t=$("<div/>").html(t).text().replace("http://","").replace("https://","").replace(domainOriginal,"").replace(domainSecond,"").replace("telegram.me/","")).split("/",2);return t=l[0],1<l.length&&(a=getNumberValue(l[1])),t=$("<div/>").html(t).text().replace(/<script>/gi,"").replace(/<script /gi,"").replace(/<\/script>/gi,"").replace(/javascript:/gi,"").replace(/["'`!@#%&=:;, .*+?^${}()|[\]\\\/]/g,"").trim(),n.name=t,n.value=a,n}function getSanitizeValue(e){var n="";return n=$("<div/>").html(e).text().replace("tg://resolve?domain=","").split("&",1),n=$("<div/>").html(n).text().replace("http://","").replace("https://","").replace(domainOriginal,"").replace(domainSecond,"").replace("telegram.me/","").split("/",1),n=$("<div/>").html(n).text().replace(/<script>/gi,"").replace(/<script /gi,"").replace(/<\/script>/gi,"").replace(/javascript:/gi,"").replace(/["'`!@#%&=:;, .*+?^${}()|[\]\\\/]/g,"").trim()}function getBooleanValue(e){var n=!1;return"boolean"==typeof e?n=e:e.toLowerCase()==="true".toLowerCase()&&(n=!0),n}function getNumberValue(e){var n=parseInt(e,10);return isNaN(n)&&(n=1),n<1&&(n=1),n}function getCurrentChannelSearch(e){if(!$.isEmptyObject(e)){var n=!0;if(e.hasOwnProperty("search")){var a=(r=getSanitizeCurrentChannelParameters(e.search)).name;if(1<(s=r.value)&&(n=!1),""!=a)-1==(o=searchElementIndexInArray(App.channels,a,"name"))?(addCurrentChannelSettings(a,s),App.channels.push(App.currentChannel)):(App.currentChannel=App.channels[o],1<s&&(App.currentChannel.value=s))}else if(e.hasOwnProperty("channel")){var t=getSanitizeValue(e.channel);if(""!=t)-1==(o=searchElementIndexInArray(App.channels,t,"name"))?(addCurrentChannelSettings(t),App.channels.push(App.currentChannel)):App.currentChannel=App.channels[o]}else if(e.hasOwnProperty("channels")){e.channels=e.channels||"";for(var l=e.channels.split(";"),i=0;i<l.length;i++){var r,s,o;a=(r=getSanitizeCurrentChannelParameters(l[i])).name;if(n=(s=r.value)<=1,""!=a)-1==(o=searchElementIndexInArray(App.channels,a,"name"))?0==i?(addCurrentChannelSettings(a,s),App.channels.push(App.currentChannel)):addCurrentChannelSettings(a,s,!0):0==i&&(App.currentChannel=App.channels[o],1<s&&(App.currentChannel.value=s))}}if(e.hasOwnProperty("proxy")&&(App.useProxy=getBooleanValue(e.proxy)),e.hasOwnProperty("view")&&(App.viewType=getSanitizeValue(e.view)),e.hasOwnProperty("step")){var p=getNumberValue(getSanitizeValue(e.step));p=30<(p=p<1?1:p)?30:p,App.step=p}$.isEmptyObject(App.currentChannel)||(e.hasOwnProperty("min")&&(App.currentChannel.min=getNumberValue(getSanitizeValue(e.min))),e.hasOwnProperty("max")&&(App.currentChannel.max=getNumberValue(getSanitizeValue(e.max))),e.hasOwnProperty("post")?App.currentChannel.value=getNumberValue(getSanitizeValue(e.post)):n&&getRandomMessage())}}function getCurrentChannelAdd(){var e=$("#searchChannel"),n=getSanitizeCurrentChannelParameters(e.val()),a=n.name,t=n.value;if(""!=a){var l=searchElementIndexInArray(App.channels,a,"name");-1==l?(addCurrentChannelSettings(a,t),App.channels.push(App.currentChannel)):(App.currentChannel=App.channels[l],1<t&&(App.currentChannel.value=t)),e.val(""),a="",renderLogoApp("#logoApp"),renderListChannel(),setRangeMessage(),getPage()}}function getRandomPage(){getRandomMessage(),getPage()}function getPrevPage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=App.currentChannel.value-App.step,getPage())}function getNextPage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=App.currentChannel.value+App.step,getPage())}function getTextSocial(){return'<hr class="my-social-hr"><ul class="nav justify-content-center"><li class="nav-item my-social"><a target="_blank" href="https://twitter.com/TGViewer/" class="nav-link"><img class="my-icon" src="ico/social-twitter.png" title="Twitter" alt="Twitter" width="24" height="24"></a></li><li class="nav-item my-social"><a target="_blank" href="https://www.instagram.com/TGViewer/" class="nav-link"><img class="my-icon" src="ico/social-instagram.png" title="Instagram" alt="Instagram" width="24" height="24"></a></li></ul>'}function getTextExampleChannel(){var e=[];e.push("Telegram"),e.push("SuperDeals"),e.push("ThisIsInterestin"),e.push("ReceptiVkusno"),e.push("Durov");for(var n="",a=0;a<e.length;a++)n+='<a href="" class="btnAddChannel badge badge-pill badge-light">'+e[a]+"</a> ";return n}function getTextSearchChannel(){return'<span><input name="searchChannel" id="searchChannel" class="form-control" type="text" id="search" placeholder="Enter telegram public channel name..." title="Enter telegram public channel name (or paste post url)"><small class="text-muted" title="Example: Telegram or Telegram/88 or https://'+domainOriginal+'Telegram/88">Example: '+getTextExampleChannel()+" etc.</small></span>"}function getCasheImage(o){$.getJSON("data/catalog.json").done(function(e){for(var n=!1,a=e,t=0;t<a.length;t++){var l=a[t],i=l.name;if(i.toLowerCase()==o.toLowerCase()){var r=l.image,s=searchElementIndexInArray(App.channels,i,"name");if(-1!=s)App.channels[s].image!=r&&(App.channels[s].image=r,App.currentChannel.name.toLowerCase()==o.toLowerCase()&&(App.currentChannel.image=r,n=!0))}}n&&(renderLogoApp("#logoApp"),renderListChannel(),setAppCashe(),my_ga("send","event","getCasheImage: "+o,"function","getCurrentChannelInfo"))})}function renderCatalogChannel_old(){$.getJSON("data/catalog.json").done(function(e){var n=!1,a=e,t=0,l="";l+="<br>",l+='<center><ul class="nav my-catalog justify-content-center">';for(var i=0;i<a.length;i++){var r=a[i],s=r.name,o=r.image,p=searchElementIndexInArray(App.channels,s,"name");if(-1==p){var d=r.title||s;l+='<li class="nav-item my-catalog-item">',l+='<a class="nav-link my-catalog-nav-link" href="?search='+s+"/"+r.currentMessage+'">',l+='<div class="card">',l+='  <img class="card-img-top img-fluid rounded-circle mx-auto d-block my-catalog-image my-empty-image lazy_load" src="" data-src="'+o+'" title="'+d+", "+s+'" alt="" onload="this.alt=\''+d+"';\">",l+='  <div class="card-footer text-muted my-catalog-footer">'+d+"</div>",l+="</div>",l+="</a>",l+="</li>",++t}else{App.channels[p].image!=o&&(App.channels[p].image=o,App.currentChannel.name.toLowerCase()==s.toLowerCase()&&(App.currentChannel.image=o),n=!0)}}l+="</ul></center>",$("#catalogChannel").html(l),0==t&&$("#catalogChannel").hide(),n&&setAppCashe(),lazyLoad()}).fail(function(e,n,a){$("#catalogChannel").html("")})}function renderCatalogChannel(){$("#catalogChannel").html('<iframe src="search.html" style="width:100%; height:444px; border:none;"></iframe>')}function renderDialogAddChannel(){var e='<div class="modal fade" id="modalDialogAddChannel" tabindex="-1" role="dialog" aria-labelledby="modalDialogAddChannelLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogAddChannelLabel">Add channel</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body">'+getTextSearchChannel()+'<div id="catalogChannel"></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogAddChannelSave" type="button" class="btn btn-primary" data-dismiss="modal">Add channel</button></div></div></div></div>';$("#modalDialog").html(e),renderCatalogChannel();var a=$("#searchChannel"),t=$(".btnAddChannel");t.click(function(e){var n=$(this).text();e.preventDefault(),e.stopPropagation(),a.val(n),t.blur(),my_ga("send","event","searchChannel: "+n,"click","btnAddChannel")}),$("#modalDialogAddChannel").on("shown.bs.modal",function(e){a.trigger("focus"),a.select()}),$("#modalDialogAddChannel").on("hidden.bs.modal",function(e){$("#modalDialog").html("")}),$("#btnDialogAddChannelSave").click(function(e){getCurrentChannelAdd(),my_ga("send","event","getCurrentChannelAdd","click","btnDialogAddChannelSave")})}function getTextSettings(){var e="";if(e+='<div class="container"><br><div id="logoAppDialog"></div><div><div class="form-group"><label for="appStep" class="bmd-label-floating">Step messages</label><input type="number" class="form-control" id="appStep" name="appStep" min="1" max="30" step="1" value="'+App.step+'"><span class="bmd-help">App step messages</span></div><div class="form-group" title="If your ISP blocks access to the Telegram servers, use the &proxy=true parameter in url (disable &proxy=false)">',e+=renderModalDialogSettingsBMD?'<div class="switch"><label><input type="checkbox" id="appUseProxy"'+(App.useProxy?" checked":"")+'><span class="bmd-switch-track"><div class="ripple-container"></div></span> Use proxy</label></div>':'<div class="switch"><label><input type="checkbox" id="appUseProxy"'+(App.useProxy?" checked":"")+"> Use proxy</label></div>",e+="</div></div>",!$.isEmptyObject(App.currentChannel)){var n=App.currentChannel.name;""!=App.currentChannel.image&&(n=App.currentChannel.title||n),e+='<div><div class="form-group"><label for="currentChannelMin" class="bmd-label-floating">Min message</label><input type="number" class="form-control" id="currentChannelMin" name="currentChannelMin" min="1" value="'+App.currentChannel.min+'"><span class="bmd-help"><b>'+n+'</b> channel min message</span></div><div class="form-group"><label for="currentChannelMax" class="bmd-label-floating">Max message</label><input type="number" class="form-control" id="currentChannelMax" name="currentChannelMax" min="1" value="'+App.currentChannel.max+'"><span class="bmd-help"><b>'+n+'</b> channel max message</span></div><div class="form-group"><label for="currentChannelValue" class="bmd-label-floating">Current message</label><input type="number" class="form-control" id="currentChannelValue" name="currentChannelValue" min="1" value="'+App.currentChannel.value+'"><span class="bmd-help"><b>'+n+"</b> channel current message</span></div></div>"}return e+='<br><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogSettingsSave" type="button" class="btn btn-primary" data-dismiss="modal">Save settings</button></div></div>'}function getTextChannelInfo(){var e="",n=App.currentChannel;if(!$.isEmptyObject(n)&&""!=n.image){var a=n.name,t=n.title||a;e+='<div class="container"><br><img style="max-width: 18rem;" class="card-img-top img-fluid rounded-circle mx-auto d-block my-empty-image" src="'+n.image+'" title="'+t+'" alt="" onload="this.alt=\''+t+'\';"><div class="card-body"><h5 class="card-title">'+t+'</h5><h6 class="card-subtitle mb-2 text-muted"><a href="https://'+domainOriginal+a+'" target="_blank">'+domainOriginal+a+"</a></h6>",0<n.members&&(e+='<p class="card-text"><small class="text-muted">'+n.members+" members</small></p>"),e+='<p class="card-text">'+n.descriptionHtml+"</p></div>",e+='<br><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogUpdateInfo" type="button" class="btn btn-primary" data-dismiss="modal">Update info</button></div></div>'}return e}function renderDialogSettings(){var e='<div class="modal fade" id="modalDialogSettings" tabindex="-1" role="dialog" aria-labelledby="modalDialogSettingsLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogSettingsLabel">Settings</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body">',n='style="display: none;"';$.isEmptyObject(App.currentChannel)||""!=App.currentChannel.image&&(n=""),e+='<ul class="nav nav-tabs" id="myTab" role="tablist" '+n+'><li class="nav-item"><a class="nav-link active" id="settings-tab" data-toggle="tab" href="#settings" role="tab" aria-controls="settings" aria-selected="true">Settings</a></li><li class="nav-item"><a class="nav-link" id="info-tab" data-toggle="tab" href="#info" role="tab" aria-controls="info" aria-selected="false">Channel info</a></li></ul><div class="tab-content" id="myTabContent"><div class="tab-pane fade show active" id="settings" role="tabpanel" aria-labelledby="settings-tab">'+getTextSettings()+'</div><div class="tab-pane fade" id="info" role="tabpanel" aria-labelledby="info-tab">'+getTextChannelInfo()+"</div></div>",e+="</div></div></div></div>",$("#modalDialog").html(e),$("#appUseProxy")[0].checked=App.useProxy||!1,renderLogoApp("#logoAppDialog"),renderModalDialogSettingsBMD||($("#modalDialog").bootstrapMaterialDesign(),renderModalDialogSettingsBMD=!0),$("#modalDialogSettings").on("shown.bs.modal",function(e){$("#appStep").trigger("focus"),$("#appStep").select()}),$("#modalDialogSettings").on("hidden.bs.modal",function(e){$("#modalDialog").html("")}),$("#btnDialogSettingsSave").click(function(e){var n=$("#appUseProxy")[0].checked;App.useProxy=n||!1;var a=getNumberValue($("#appStep").val());if(a=30<(a=a<1?1:a)?30:a,App.step=a,!$.isEmptyObject(App.currentChannel)){var t=getNumberValue($("#currentChannelMin").val()),l=getNumberValue($("#currentChannelMax").val()),i=getNumberValue($("#currentChannelValue").val());i=(l=l<(t=l<t?l:t)?t:l)<(i=i<t?t:i)?l:i,App.currentChannel.min=t,App.currentChannel.max=l,App.currentChannel.value=i,setRangeMessage(),getPage()}setAppCashe(),my_ga("send","event","renderDialogSettingsSave","click","btnDialogSettingsSave")}),$("#btnDialogUpdateInfo").click(function(e){$.isEmptyObject(App.currentChannel)||getCurrentChannelInfo(App.currentChannel.name),my_ga("send","event","renderDialogSettingsSave","click","btnDialogUpdateInfo")})}function renderDialogAbout(){var e='<div class="modal fade" id="modalDialogAbout" tabindex="-1" role="dialog" aria-labelledby="modalDialogAboutLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogAboutLabel">About</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><center><h4>'+App.name+'</h4><br/><img class="img-fluid rounded" src="ico/android-chrome-192x192.png" width="120" height="120" alt="'+App.name+'"><br/><br/><p>Telegram public channel viewer</p>'+getTextSocial()+'</center></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button></div></div></div></div>';$("#modalDialog").html(e),$("#modalDialogAbout").on("hidden.bs.modal",function(e){$("#modalDialog").html("")})}function renderRightMenuApp(){420<$(window).width()?$("#rightMenuApp").html('<div id="changeViewType"></div><button id="btnDialogAddChannel" type="button" class="btn bmd-btn-icon" data-toggle="modal" data-target="#modalDialogAddChannel" title="Add new channel"><i class="material-icons">add</i></button><div id="deleteChannel"></div><div class="dropdown pull-xs-right"><button class="btn bmd-btn-icon dropdown-toggle" type="button" id="lr1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="material-icons">more_vert</i></button><div id="rightDropdownMenuApp" class="dropdown-menu dropdown-menu-right" aria-labelledby="lr1"><button id="btnDialogSettings" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogSettings"><i class="material-icons my-icon-dropdown">settings</i> Settings</button><div class="dropdown-divider"> </div><button id="btnDialogAbout" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAbout"><i class="material-icons my-icon-dropdown">info</i> About</button></div></div>'):$("#rightMenuApp").html('<div class="dropdown pull-xs-right"><button class="btn bmd-btn-icon dropdown-toggle" type="button" id="lr1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="material-icons">more_vert</i></button><div id="rightDropdownMenuApp" class="dropdown-menu dropdown-menu-right" aria-labelledby="lr1"><div id="changeViewType"></div><button id="btnDialogAddChannel" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAddChannel"><i class="material-icons my-icon-dropdown">add</i> Add channel</button><div id="deleteChannel"></div><button id="btnDialogSettings" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogSettings"><i class="material-icons my-icon-dropdown">settings</i> Settings</button><div class="dropdown-divider"> </div><button id="btnDialogAbout" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAbout"><i class="material-icons my-icon-dropdown">info</i> About</button></div></div>'),renderViewType(),toggleDeleteChannel(),$("#btnDialogAddChannel").click(function(e){renderDialogAddChannel(),my_ga("send","event","renderDialogAddChannel","click","btnDialogAddChannel")}),$("#btnDialogSettings").click(function(e){renderDialogSettings(),my_ga("send","event","renderDialogSettings","click","btnDialogSettings")}),$("#btnDialogAbout").click(function(e){renderDialogAbout(),my_ga("send","event","renderDialogAbout","click","btnDialogAbout")})}function processScreenResizing(){setMenuHeight(),renderRightMenuApp()}function getFixClass(){return navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?(my_ga("send","event","getFixClass","ios","platform: "+navigator.platform),"my-menu-app-ios"):/Edge\/\d./i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","edge","userAgent: "+navigator.userAgent),"my-menu-app-edge"):/rv:11.0/i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","ie11","userAgent: "+navigator.userAgent),"my-menu-app-ie11"):/MSIE 10/i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","ie10","userAgent: "+navigator.userAgent),"my-menu-app-ie10"):/MSIE 9/i.test(navigator.userAgent)||/MSIE/i.test(navigator.userAgent)?(isOldBrowser=!0,my_ga("send","event","getFixClass","ie9-and-oldies","userAgent: "+navigator.userAgent),"my-menu-app-ie9-and-oldies"):(my_ga("send","event","getFixClass","other","userAgent: "+navigator.userAgent),"my-menu-app")}function preRenderPage(){var e="",n=getFixClass();if(isOldBrowser){var a='<a href="https://www.google.com/chrome/" target="_blank" title="'+navigator.userAgent+'">Your browser is out of date</a>';return e='<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;"><h4>'+App.name+'</h4><br/><img class="img-fluid rounded" src="ico/android-chrome-192x192.png" width="120" height="120" alt="'+App.name+'"><br/><br/><p>Telegram public channel viewer</p><p>'+a+"</p>"+getTextSocial()+"<div>",void $("#app").html(e)}e='<header><nav class="my-navbar navbar fixed-top navbar-light bg-light"><a class="navbar-brand" href=""><div class="my-dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><div id="menuApp" class="'+n+'"><i class="material-icons">menu</i></div><div id="logoApp"></div></div><div id="dropdownMenuChannel" class="dropdown-menu"><div id="listChannel"></div></div></a><div id="rightMenuApp" class="form-inline"></div></nav></header><div id="modalDialog"></div><div id="mainPage"><center><div class="range-message">',$.isEmptyObject(App.currentChannel)?e+='<input type="range" name="rangeMessage" id="rangeMessage" oninput="getStartMessage();" onchange="getPage();" min="1" max="1" step="1" value="1">':e+='<input type="range" name="rangeMessage" id="rangeMessage" oninput="getStartMessage();" onchange="getPage();" min="'+App.currentChannel.min+'" max="'+App.currentChannel.max+'" step="'+App.step+'" value="'+App.currentChannel.value+'">',e+='</div><main id="main" role="main" class="container-fluid"></main></center></div>',$("#app").html(e),renderLogoApp("#logoApp"),renderListChannel(),renderRightMenuApp(),$(".navbar-brand").click(function(e){e.preventDefault(),setMenuHeight()})}function getPage(){if(!isOldBrowser){if($.isEmptyObject(App.currentChannel)){var e=0<App.channels.length?"Select channel to view":"No channels to view";a='<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;"><a class="nav-link" href="?search=Telegram/88" title="'+App.name+'"><img class="img-fluid rounded" src="ico/android-chrome-192x192.png" width="120" height="120" alt="'+App.name+'"></a><br/><br/><p>'+e+"</p>"+getTextSocial()+"<div>";$("#main").html(a),$(".range-message").hide(),$("body").bootstrapMaterialDesign(),document.title=""+App.name;r=""+location.pathname;history.pushState(null,null,r)}else{App.currentChannel.lastView=getCurrentDateValue(),App.currentChannel.value<App.currentChannel.min&&(App.currentChannel.value=App.currentChannel.min),App.currentChannel.value>App.currentChannel.max-App.step&&(App.currentChannel.max=App.currentChannel.value+App.step);var n=[],a="";a+='<div class="posts">',a+='<ol class="nav justify-content-center">';for(var t=0;t<App.step;t++){var l=App.currentChannel.name+"/"+(App.currentChannel.value+t),i=l.replace("/","-");n.push(i),a+='<li class="post-item '+("list"==App.viewType?"view-list":"view-table")+'">',a+='<div class="post">',App.useProxy?a+='<script async src="js/telegram-widget.js" data-telegram-post="'+l+'" data-width="100%"><\/script>':a+='<script async src="https://telegram.org/js/telegram-widget.js" data-telegram-post="'+l+'" data-width="100%"><\/script>',a+="</div>",a+="</li>"}a+="</ol>",a+="</div>",a+='<div class="posts-footer"></div>',a+='<nav class="my-pagination"><ul class="pagination justify-content-center"><li class="page-item"><span id="elementPrevPageFooter" class="page-link">Previous</span></li><li class="page-item"><span id="elementNextPageFooter" class="page-link">Next</span></li></ul></nav>',$("#main").html(a),$("#rangeMessage").val(App.currentChannel.value),$(".range-message").show(),$("body").bootstrapMaterialDesign(),document.title=App.currentChannel.name+" - "+App.currentChannel.value+" - "+App.name;var r=location.pathname+"?channel="+App.currentChannel.name+"&post="+App.currentChannel.value;history.pushState(null,null,r),$("#elementPrevPageFooter").click(function(e){getPrevPage(),my_ga("send","event","getPrevPage","click","elementPrevPageFooter")}),$("#elementNextPageFooter").click(function(e){getNextPage(),my_ga("send","event","getNextPage","click","elementNextPageFooter")})}setAppCashe()}}function parseUrlQuery(){var e={};if(window.location.search)for(var n=window.location.search.substr(1).split("&"),a=0;a<n.length;a++){var t=n[a].split("=");e[t[0].toLowerCase()]=t[1].toLowerCase()}return e}function addOnWheel(e,n){e.addEventListener&&("onwheel"in document?e.addEventListener("wheel",n):"onmousewheel"in document?e.addEventListener("mousewheel",n):e.addEventListener("MozMousePixelScroll",n))}function setMenuHeight(){var e=260;try{e=window.innerHeight-60}catch(e){my_ga("send","event","setMenuHeight","Error",e)}$("#dropdownMenuChannel").css("max-height",e)}function setAppCashe(){try{var e=localStorage.getItem("App"),n=JSON.stringify(App);e!==n&&localStorage.setItem("App",n)}catch(e){my_ga("send","event","setAppCashe","Error",e)}}function getAppCashe(){try{var e=localStorage.getItem("App");null!=e&&(App=JSON.parse(e))}catch(e){my_ga("send","event","getAppCashe","Error",e)}}function my_ga(e,n,a,t,l){try{ga(e,n,a,t,l)}catch(l){}}function document_ready(){getAppCashe(),""!=window.location.search&&getCurrentChannelSearch(parseUrlQuery()),preRenderPage(),getPage();var t=void 0,l=void 0;try{document.addEventListener("touchstart",function(e){"posts-footer"==e.target.className&&(t=e.changedTouches[0])})}catch(e){my_ga("send","event","addEventListener","Error-touchstart",e)}try{document.addEventListener("touchend",function(e){if("posts-footer"==e.target.className){l=e.changedTouches[0];var n=Math.abs(t.pageX-l.pageX),a=Math.abs(t.pageY-l.pageY);(20<n||20<a)&&(a<n?l.pageX<t.pageX?(getNextPage(),my_ga("send","event","getNextPage","touchend","document")):(getPrevPage(),my_ga("send","event","getPrevPage","touchend","document")):(l.pageY,t.pageY))}})}catch(e){my_ga("send","event","addEventListener","Error-touchend",e)}try{addOnWheel(document,function(e){"posts-footer"==e.target.className&&(0<(e.deltaY||e.detail||e.wheelDelta)?(getNextPage(),my_ga("send","event","getNextPage","wheel","document")):(getPrevPage(),my_ga("send","event","getPrevPage","wheel","document")),e.preventDefault())})}catch(e){my_ga("send","event","addOnWheel","Error-wheel",e)}}$(document).ready(function(){document_ready()}),$(document).keydown(function(e){""==e.target.className&&(37==e.which&&(getPrevPage(),my_ga("send","event","getPrevPage","keydown","document")),36==e.which&&(getRandomPage(),my_ga("send","event","getRandomPage","keydown","document")),39==e.which&&(getNextPage(),my_ga("send","event","getNextPage","keydown","document")))}),$(window).resize(function(){processScreenResizing(),my_ga("send","event","processScreenResizing","resize","window: ("+$(window).width()+"x"+$(window).height()+")")}),$(window).on("popstate",function(e){document_ready(),my_ga("send","event","document_ready","popstate","window: "+location.href)});
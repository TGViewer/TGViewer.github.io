var App={name:"TGViewer",useProxy:!1,viewType:"list",step:6,channels:[],currentChannel:{}},renderModalDialogSettingsBMD=!1,isOldBrowser=!1,domainOriginal="t.me/",domainSecond="tele.click/",arrayCatalogChannel=[];function getRandomIndex(e,a){return Math.floor(e+Math.random()*(a+1-e))}function getRandomMessage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=getRandomIndex(App.currentChannel.min,App.currentChannel.max))}function getStartMessage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=getNumberValue($("#rangeMessage").val()))}function setRangeMessage(){if(!$.isEmptyObject(App.currentChannel)){var e=$("#rangeMessage")[0];e.step=App.step,e.min=App.currentChannel.min,e.max=App.currentChannel.max,e.value=App.currentChannel.value}}function searchElementIndexInArray(e,a,n){for(var t=-1,l=e,i=0;i<l.length;i++){var r=l[i];if(r.hasOwnProperty(n)&&r[n].toLowerCase()===a.toLowerCase())return t=i}return t}function imgLoaded(e){$(e).parent().addClass("loaded")}function lazyLoad(){$(".lazy_load").each(function(){var e=$(this);""!=e.attr("data-src")&&e.on("load",imgLoaded(e[0])).attr("src",e.attr("data-src")).attr("data-src","")})}function renderLogoApp(e){if($.isEmptyObject(App.currentChannel)){var a=App.name;$(e).html('<img class="d-inline-block align-top rounded-circle" src="ico/favicon-32x32.png" width="32" height="32" title="'+a+'" alt="'+a+'"><span class="logo-app">'+a+"</span>")}else if(""!=App.currentChannel.image){var n=App.currentChannel.title||App.currentChannel.name;$(e).html('<img class="d-inline-block align-top rounded-circle tgv-empty-image" src="'+App.currentChannel.image+'" width="32" height="32" title="'+n+'" alt="" onload="this.alt=\''+n+'\';"><span class="logo-app">'+n+"</span>")}else{var t=App.currentChannel.name;$(e).html('<span class="letter-circle" title="'+t+'">'+t.substr(0,2).toUpperCase()+'</span><span class="logo-app">'+t+"</span>")}}function renderCatalogFrame(){getAppCashe(),void 0===App.currentCatalogPage&&(App.currentCatalogPage=getRandomIndex(1,96),setAppCashe());var e='<iframe class="tgv-catalog-frame" src="https://tgviewer.github.io/channel/page/'+App.currentCatalogPage+'"></iframe>';$("#main").html(e),$("#main").removeClass("container-fluid"),$(".tgv-pagination-footer").hide(),$("#changeViewType").hide(),$("#deleteChannel").html(""),App.currentChannel={},renderLogoApp("#logoApp")}function addEventForBtnSelectChannel(){$("#btnSelectChannel").click(function(e){renderCatalogFrame()})}function renderListChannel(){if(0<App.channels.length){var e="";e+='<h6 id="btnSelectChannel" class="dropdown-header">Select channel</h6>';for(var a=0;a<App.channels.length;a++){var n=App.channels[a].name,t=App.channels[a].title||n,l=App.channels[a].image;e+=""!=l?'<button class="dropdown-item list-channel-item" type="button"><img class="d-inline-block align-top rounded-circle logo-channel-img channel-item tgv-empty-image lazy_load" src="" data-src="'+l+'" width="32" height="32" data-name="'+n+'" title="'+t+'" alt="" onload="this.alt=\''+t+'\';"><span class="name-channel">'+t+"</span></button>":'<button class="dropdown-item list-channel-item" type="button"><span class="letter-circle logo-channel channel-item" data-name="'+n+'" title="'+n+'">'+n.substr(0,2).toUpperCase()+'</span><span class="name-channel">'+n+"</span></button>"}if($("#listChannel").html(e),addEventForBtnSelectChannel(),""!=e)lazyLoad(),$(".list-channel-item").click(function(e){var a=$(this).find(".channel-item").attr("data-name");App.currentChannel=App.channels[searchElementIndexInArray(App.channels,a,"name")];var n=App.currentChannel;try{""!=n.image&&""!=n.title&&0!=n.lastUpdate||getCurrentChannelInfo(n.name)}catch(e){my_ga("send","event","selectChannel: "+a,"error","getCurrentChannelInfo")}renderLogoApp("#logoApp"),renderViewType(),toggleDeleteChannel(),getPage(),my_ga("send","event","selectChannel: "+a,"click","listChannelItem")})}else $("#listChannel").html('<h6 id="btnSelectChannel" class="dropdown-header">Add channels to select</h6>'),addEventForBtnSelectChannel();toggleDeleteChannel()}function toggleDeleteChannel(){$.isEmptyObject(App.currentChannel)?$("#deleteChannel").html(""):(420<$(window).width()?$("#deleteChannel").html('<button id="btnDeleteChannel" type="button" class="btn bmd-btn-icon" title="Delete current channel"><i class="material-icons">delete</i></button>'):$("#deleteChannel").html('<button id="btnDeleteChannel" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">delete</i> Delete channel</button>'),$("#btnDeleteChannel").click(function(e){deleteCurrentChannel(),my_ga("send","event","deleteCurrentChannel","click","btnDeleteChannel")}))}function renderViewType(){420<$(window).width()?"list"==App.viewType?$("#changeViewType").html('<button id="btnViewType" type="button" class="btn bmd-btn-icon" title="Table view"><i class="material-icons">view_module</i></button>'):$("#changeViewType").html('<button id="btnViewType" type="button" class="btn bmd-btn-icon" title="List view"><i class="material-icons">view_list</i></button>'):"list"==App.viewType?$("#changeViewType").html('<button id="btnViewType" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">view_module</i> Table view</button><div id="btnViewTypeDivider" class="dropdown-divider"> </div>'):$("#changeViewType").html('<button id="btnViewType" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">view_list</i> List view</button><div id="btnViewTypeDivider" class="dropdown-divider"> </div>'),$("#btnViewType").click(function(e){toggleViewType(),my_ga("send","event","toggleViewType: "+App.viewType,"click","btnViewType")}),$.isEmptyObject(App.currentChannel)?$("#changeViewType").hide():$("#changeViewType").show()}function toggleViewType(){App.viewType="list"==App.viewType?"table":"list",renderViewType(),getPage()}function deleteCurrentChannel(){$.isEmptyObject(App.currentChannel)||0<App.channels.length&&(App.channels.splice(searchElementIndexInArray(App.channels,App.currentChannel.name,"name"),1),App.currentChannel={},renderLogoApp("#logoApp"),renderListChannel(),setAppCashe(),getPage())}function getCurrentChannelSettings_ArrayCatalogChannel(e,a){for(var n=!1,t=0;t<arrayCatalogChannel.length;t++){var l=arrayCatalogChannel[t],i=l.name;if(i.toLowerCase()==e.toLowerCase()){var r=l.image,o=l.minMessage,s=l.maxMessage,p=searchElementIndexInArray(App.channels,i,"name");if(-1!=p){var d=App.channels[p];d.image=r,d.min=o,d.max=s,d.value=1<a?a:getRandomIndex(d.min,d.max),d.value<d.min&&(d.value=d.min),App.currentChannel.name.toLowerCase()==e.toLowerCase()&&(App.currentChannel=d,setRangeMessage(),n=!0)}}}n&&(setAppCashe(),my_ga("send","event","getCurrentChannelSettings: "+e,"function","addCurrentChannelSettings"))}function getCurrentChannelSettings(a,n){0<arrayCatalogChannel.length?getCurrentChannelSettings_ArrayCatalogChannel(a,n):$.getJSON("data/catalog.json").done(function(e){arrayCatalogChannel=e,getCurrentChannelSettings_ArrayCatalogChannel(a,n)})}function addCurrentChannelSettings(e,a,n){var t=e,l=1,i=l+App.step;n=n||!1,1<(a=a||1)?i=a+App.step:a=l;var r={name:t,min:l=i<l?i:l,max:i=i<l?l:i,value:a=i<(a=a<l?l:a)?i:a,title:"",image:"",description:"",descriptionHtml:"",members:0,lastUpdate:0,lastView:0};n?App.channels.push(r):(App.currentChannel=r,App.channels.push(App.currentChannel),getCurrentChannelInfo(App.currentChannel.name)),getCurrentChannelSettings(e,a)}function p(e,a){e.push(a)}function getCurrentChannelInfo(a){var e=[];p(e,"h"),p(e,"t"),p(e,"t"),p(e,"p"),p(e,"s"),p(e,":"),p(e,"/"),p(e,"/"),p(e,"s"),p(e,"c"),p(e,"r"),p(e,"i"),p(e,"p"),p(e,"t"),p(e,"."),p(e,"g"),p(e,"o"),p(e,"o"),p(e,"g"),p(e,"l"),p(e,"e"),p(e,"."),p(e,"c"),p(e,"o"),p(e,"m"),p(e,"/"),p(e,"m"),p(e,"a"),p(e,"c"),p(e,"r"),p(e,"o"),p(e,"s"),p(e,"/"),p(e,"s"),p(e,"/"),p(e,"A"),p(e,"K"),p(e,"f"),p(e,"y"),p(e,"c"),p(e,"b"),p(e,"x"),p(e,"c"),p(e,"B"),p(e,"Y"),p(e,"e"),p(e,"E"),p(e,"9"),p(e,"E"),p(e,"q"),p(e,"s"),p(e,"9"),p(e,"d"),p(e,"q"),p(e,"p"),p(e,"S"),p(e,"e"),p(e,"B"),p(e,"r"),p(e,"b"),p(e,"4"),p(e,"R"),p(e,"e"),p(e,"2"),p(e,"q"),p(e,"3"),p(e,"w"),p(e,"T"),p(e,"j"),p(e,"o"),p(e,"f"),p(e,"q"),p(e,"1"),p(e,"5"),p(e,"_"),p(e,"b"),p(e,"w"),p(e,"V"),p(e,"i"),p(e,"s"),p(e,"Z"),p(e,"_"),p(e,"4"),p(e,"C"),p(e,"n"),p(e,"5"),p(e,"d"),p(e,"h"),p(e,"j"),p(e,"4"),p(e,"/"),p(e,"e"),p(e,"x"),p(e,"e"),p(e,"c"),p(e,"?"),p(e,"c"),p(e,"h"),p(e,"a"),p(e,"n"),p(e,"n"),p(e,"e"),p(e,"l"),p(e,"=");var n=""+e.join("")+a;$.ajax({url:n,success:function(e){e.result&&(App.currentChannel.title=e.title||a,App.currentChannel.image=e.image,App.currentChannel.description=e.description,App.currentChannel.descriptionHtml=e.descriptionHtml,App.currentChannel.members=e.members,App.currentChannel.lastUpdate=getCurrentDateValue(),setAppCashe(),my_ga("send","event","getCurrentChannelInfo: "+a,"function","addCurrentChannelSettings"))}})}function getCurrentDateValue(){return(new Date).valueOf()}function getDateWithValue(e){return new Date(e)}function getSanitizeCurrentChannelParameters(e){var a={},n=1,t="";t=$("<div/>").html(e).text().replace("tg://resolve?domain=","").split("&",1);var l=(t=$("<div/>").html(t).text().replace("http://","").replace("https://","").replace(domainOriginal,"").replace(domainSecond,"").replace("tglink.ru/","").replace("telegram.me/","")).split("/",2);return t=l[0],1<l.length&&(n=getNumberValue(l[1])),t=$("<div/>").html(t).text().replace(/<script>/gi,"").replace(/<script /gi,"").replace(/<\/script>/gi,"").replace(/javascript:/gi,"").replace(/["'`!@#%&=:;, .*+?^${}()|[\]\\\/]/g,"").trim(),a.name=t,a.value=n,a}function getSanitizeValue(e){var a="";return a=$("<div/>").html(e).text().replace("tg://resolve?domain=","").split("&",1),a=$("<div/>").html(a).text().replace("http://","").replace("https://","").replace(domainOriginal,"").replace(domainSecond,"").replace("tglink.ru/","").replace("telegram.me/","").split("/",1),a=$("<div/>").html(a).text().replace(/<script>/gi,"").replace(/<script /gi,"").replace(/<\/script>/gi,"").replace(/javascript:/gi,"").replace(/["'`!@#%&=:;, .*+?^${}()|[\]\\\/]/g,"").trim()}function getBooleanValue(e){var a=!1;return"boolean"==typeof e?a=e:e.toLowerCase()==="true".toLowerCase()&&(a=!0),a}function getNumberValue(e){var a=parseInt(e,10);return isNaN(a)&&(a=1),a<1&&(a=1),a}function getCurrentChannelSearch(e){if(!$.isEmptyObject(e)){var a=!0;if(e.hasOwnProperty("search")){var n=(r=getSanitizeCurrentChannelParameters(e.search)).name;if(1<(o=r.value)&&(a=!1),""!=n)-1==(s=searchElementIndexInArray(App.channels,n,"name"))?addCurrentChannelSettings(n,o):(App.currentChannel=App.channels[s],1<o&&(App.currentChannel.value=o))}else if(e.hasOwnProperty("channel")){var t=getSanitizeValue(e.channel);if(""!=t)-1==(s=searchElementIndexInArray(App.channels,t,"name"))?addCurrentChannelSettings(t):App.currentChannel=App.channels[s]}else if(e.hasOwnProperty("channels")){e.channels=e.channels||"";for(var l=e.channels.split(";"),i=0;i<l.length;i++){var r,o,s;n=(r=getSanitizeCurrentChannelParameters(l[i])).name;if(a=(o=r.value)<=1,""!=n)-1==(s=searchElementIndexInArray(App.channels,n,"name"))?0==i?addCurrentChannelSettings(n,o):addCurrentChannelSettings(n,o,!0):0==i&&(App.currentChannel=App.channels[s],1<o&&(App.currentChannel.value=o))}}if(e.hasOwnProperty("proxy")&&(App.useProxy=getBooleanValue(e.proxy)),e.hasOwnProperty("view")&&(App.viewType=getSanitizeValue(e.view)),e.hasOwnProperty("step")){var p=getNumberValue(getSanitizeValue(e.step));p=30<(p=p<1?1:p)?30:p,App.step=p}$.isEmptyObject(App.currentChannel)||(e.hasOwnProperty("min")&&(App.currentChannel.min=getNumberValue(getSanitizeValue(e.min))),e.hasOwnProperty("max")&&(App.currentChannel.max=getNumberValue(getSanitizeValue(e.max))),e.hasOwnProperty("post")?App.currentChannel.value=getNumberValue(getSanitizeValue(e.post)):a&&30<App.currentChannel.max&&getRandomMessage())}}function getCurrentChannelAdd(){var e=$("#searchChannel"),a=getSanitizeCurrentChannelParameters(e.val()),n=a.name,t=a.value;if(""!=n){var l=searchElementIndexInArray(App.channels,n,"name");-1==l?addCurrentChannelSettings(n,t):(App.currentChannel=App.channels[l],1<t&&(App.currentChannel.value=t)),e.val(""),n="",renderLogoApp("#logoApp"),renderListChannel(),getPage()}}function getRandomPage(){getRandomMessage(),getPage()}function getPrevPage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=App.currentChannel.value-App.step,getPage())}function getNextPage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=App.currentChannel.value+App.step,getPage())}function getTextSocial(){return'<hr class="tgv-social-hr"><ul class="nav justify-content-center"><li class="nav-item tgv-social"><a target="_blank" href="https://twitter.com/TGViewer/" class="nav-link"><img class="tgv-icon" src="ico/social-twitter.png" title="Twitter" alt="Twitter" width="24" height="24"></a></li><li class="nav-item tgv-social"><a target="_blank" href="https://www.instagram.com/TGViewer/" class="nav-link"><img class="tgv-icon" src="ico/social-instagram.png" title="Instagram" alt="Instagram" width="24" height="24"></a></li></ul>'}function getTextExampleChannel(){var e=[];e.push("Telegram"),e.push("GeeksChannel"),e.push("TechHype"),e.push("BestMemes"),e.push("HotVibes"),e.push("SuperDeals");for(var a="",n=0;n<e.length;n++)a+='<a href="" class="btnAddChannel badge badge-pill badge-light">'+e[n]+"</a> ";return a}function getTextSearchChannel(){return'<span><input name="searchChannel" list="searchListChannel" id="searchChannel" class="form-control" type="text" id="search" placeholder="Enter telegram public channel name..." title="Enter telegram public channel name (or paste post url)"><datalist id="searchListChannel"></datalist><small class="text-muted" title="Example: Telegram or Telegram/88 or https://'+domainOriginal+'Telegram/88">Example: '+getTextExampleChannel()+' etc.</small></span><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogAddChannelSave" type="button" class="btn btn-primary" data-dismiss="modal">Add channel</button></div>'}function getSearchListChannel_ArrayCatalogChannel(){for(var e="",a=0;a<arrayCatalogChannel.length;a++){var n=arrayCatalogChannel[a],t=n.name;e+='<option value="'+t+'">'+t+": "+n.title+"</option>"}""!=e&&$("#searchListChannel").html(e)}function getSearchListChannel(){0<arrayCatalogChannel.length?getSearchListChannel_ArrayCatalogChannel():$.getJSON("data/catalog.json").done(function(e){arrayCatalogChannel=e,getSearchListChannel_ArrayCatalogChannel()})}function renderDialogAddChannel(){var e='<div class="modal fade" id="modalDialogAddChannel" tabindex="-1" role="dialog" aria-labelledby="modalDialogAddChannelLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogAddChannelLabel">Add channel</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body">';e+='<ul class="nav nav-tabs" id="myTab" role="tablist"><li class="nav-item"><a class="nav-link active" id="add-tab" data-toggle="tab" href="#add" role="tab" aria-controls="add" aria-selected="true">Add</a></li><li class="nav-item"><a class="nav-link" id="search-tab" data-toggle="tab" href="#search" role="tab" aria-controls="search" aria-selected="false">Search</a></li></ul><div class="tab-content" id="myTabContent"><div class="tab-pane fade show active" id="add" role="tabpanel" aria-labelledby="add-tab">'+getTextSearchChannel()+'</div><div class="tab-pane fade" id="search" role="tabpanel" aria-labelledby="search-tab"><div id="catalogChannel"><iframe src="search.html" style="width:100%; height:444px; border:none;"></iframe></div></div></div>',e+="</div></div></div></div>",$("#modalDialog").html(e),getSearchListChannel();var n=$("#searchChannel"),t=$(".btnAddChannel");t.click(function(e){var a=$(this).text();e.preventDefault(),e.stopPropagation(),n.val(a),t.blur(),my_ga("send","event","searchChannel: "+a,"click","btnAddChannel")}),$("#modalDialogAddChannel").on("shown.bs.modal",function(e){n.trigger("focus"),n.select()}),$("#modalDialogAddChannel").on("hidden.bs.modal",function(e){$("#modalDialog").html("")}),$("#btnDialogAddChannelSave").click(function(e){getCurrentChannelAdd(),my_ga("send","event","getCurrentChannelAdd","click","btnDialogAddChannelSave")})}function getTextSettings(){var e="";if(e+='<div class="container"><br><div id="logoAppDialog"></div><div><div class="form-group"><label for="appStep" class="bmd-label-floating">Step messages</label><input type="number" class="form-control" id="appStep" name="appStep" min="1" max="30" step="1" value="'+App.step+'"><span class="bmd-help">App step messages</span></div><div class="form-group" title="If your ISP blocks access to the Telegram servers, use the &proxy=true parameter in url (disable &proxy=false)">',e+=renderModalDialogSettingsBMD?'<div class="switch"><label><input type="checkbox" id="appUseProxy"'+(App.useProxy?" checked":"")+'><span class="bmd-switch-track"><div class="ripple-container"></div></span> Use proxy</label></div>':'<div class="switch"><label><input type="checkbox" id="appUseProxy"'+(App.useProxy?" checked":"")+"> Use proxy</label></div>",e+="</div></div>",!$.isEmptyObject(App.currentChannel)){var a=App.currentChannel.name;""!=App.currentChannel.image&&(a=App.currentChannel.title||a),e+='<div><div class="form-group"><label for="currentChannelMin" class="bmd-label-floating">Min message</label><input type="number" class="form-control" id="currentChannelMin" name="currentChannelMin" min="1" value="'+App.currentChannel.min+'"><span class="bmd-help"><b>'+a+'</b> channel min message</span></div><div class="form-group"><label for="currentChannelMax" class="bmd-label-floating">Max message</label><input type="number" class="form-control" id="currentChannelMax" name="currentChannelMax" min="1" value="'+App.currentChannel.max+'"><span class="bmd-help"><b>'+a+'</b> channel max message</span></div><div class="form-group"><label for="currentChannelValue" class="bmd-label-floating">Current message</label><input type="number" class="form-control" id="currentChannelValue" name="currentChannelValue" min="1" value="'+App.currentChannel.value+'"><span class="bmd-help"><b>'+a+"</b> channel current message</span></div></div>"}return e+='<br><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogSettingsSave" type="button" class="btn btn-primary" data-dismiss="modal">Save settings</button></div></div>'}function getTextChannelInfo(){var e="",a=App.currentChannel;if(!$.isEmptyObject(a)&&""!=a.image){var n=a.name,t=a.title||n;e+='<div class="container"><br><a href="tg://resolve?domain='+n+'"><img class="card-img-top img-fluid rounded-circle mx-auto d-block tgv-empty-image" src="'+a.image+'" title="'+t+'" alt="" onload="this.alt=\''+t+'\';"></a><div class="card-body"><h5 class="card-title">'+t+'</h5><h6 class="card-subtitle mb-2 text-muted"><a href="https://'+domainOriginal+n+'" target="_blank">'+domainOriginal+n+"</a></h6>",0<a.members&&(e+='<p class="card-text"><small class="text-muted">'+a.members+" members</small></p>"),e+='<p class="card-text">'+a.descriptionHtml+"</p></div>",e+='<br><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogUpdateInfo" type="button" class="btn btn-primary" data-dismiss="modal">Update info</button></div></div>'}return e}function renderDialogSettings(){var e='<div class="modal fade" id="modalDialogSettings" tabindex="-1" role="dialog" aria-labelledby="modalDialogSettingsLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogSettingsLabel">Settings</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body">',a='style="display: none;"';$.isEmptyObject(App.currentChannel)||""!=App.currentChannel.image&&(a=""),e+='<ul class="nav nav-tabs" id="myTab" role="tablist" '+a+'><li class="nav-item"><a class="nav-link active" id="settings-tab" data-toggle="tab" href="#settings" role="tab" aria-controls="settings" aria-selected="true">Settings</a></li><li class="nav-item"><a class="nav-link" id="info-tab" data-toggle="tab" href="#info" role="tab" aria-controls="info" aria-selected="false">Channel info</a></li></ul><div class="tab-content" id="myTabContent"><div class="tab-pane fade show active" id="settings" role="tabpanel" aria-labelledby="settings-tab">'+getTextSettings()+'</div><div class="tab-pane fade" id="info" role="tabpanel" aria-labelledby="info-tab">'+getTextChannelInfo()+"</div></div>",e+="</div></div></div></div>",$("#modalDialog").html(e),$("#appUseProxy")[0].checked=App.useProxy||!1,renderLogoApp("#logoAppDialog"),renderModalDialogSettingsBMD||($("#modalDialog").bootstrapMaterialDesign(),renderModalDialogSettingsBMD=!0),$("#modalDialogSettings").on("shown.bs.modal",function(e){$("#appStep").trigger("focus"),$("#appStep").select()}),$("#modalDialogSettings").on("hidden.bs.modal",function(e){$("#modalDialog").html("")}),$("#btnDialogSettingsSave").click(function(e){var a=$("#appUseProxy")[0].checked;App.useProxy=a||!1;var n=getNumberValue($("#appStep").val());if(n=30<(n=n<1?1:n)?30:n,App.step=n,!$.isEmptyObject(App.currentChannel)){var t=getNumberValue($("#currentChannelMin").val()),l=getNumberValue($("#currentChannelMax").val()),i=getNumberValue($("#currentChannelValue").val());i=(l=l<(t=l<t?l:t)?t:l)<(i=i<t?t:i)?l:i,App.currentChannel.min=t,App.currentChannel.max=l,App.currentChannel.value=i,getPage()}setAppCashe(),my_ga("send","event","renderDialogSettingsSave","click","btnDialogSettingsSave")}),$("#btnDialogUpdateInfo").click(function(e){$.isEmptyObject(App.currentChannel)||getCurrentChannelInfo(App.currentChannel.name),my_ga("send","event","renderDialogSettingsSave","click","btnDialogUpdateInfo")})}function renderDialogAbout(){var e='<div class="modal fade" id="modalDialogAbout" tabindex="-1" role="dialog" aria-labelledby="modalDialogAboutLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogAboutLabel">About</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><center><h4>'+App.name+'</h4><br/><img class="img-fluid rounded" src="ico/android-chrome-192x192.png" width="120" height="120" alt="'+App.name+'"><br/><br/><p>Telegram public channel viewer</p>'+getTextSocial()+'</center></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button></div></div></div></div>';$("#modalDialog").html(e),$("#modalDialogAbout").on("hidden.bs.modal",function(e){$("#modalDialog").html("")})}function renderRightMenuApp(){420<$(window).width()?$("#rightMenuApp").html('<div id="changeViewType"></div><button id="btnDialogAddChannel" type="button" class="btn bmd-btn-icon" data-toggle="modal" data-target="#modalDialogAddChannel" title="Add new channel"><i class="material-icons">add</i></button><div id="deleteChannel"></div><div class="dropdown pull-xs-right"><button class="btn bmd-btn-icon dropdown-toggle" type="button" id="lr1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="material-icons">more_vert</i></button><div id="rightDropdownMenuApp" class="dropdown-menu dropdown-menu-right" aria-labelledby="lr1"><button id="btnDialogSettings" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogSettings"><i class="material-icons tgv-icon-dropdown">settings</i> Settings</button><button id="btnDialogAbout" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAbout"><i class="material-icons tgv-icon-dropdown">info</i> About</button><div class="dropdown-divider"> </div><button id="btnExit" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">exit_to_app</i> Exit</button></div></div>'):$("#rightMenuApp").html('<div class="dropdown pull-xs-right"><button class="btn bmd-btn-icon dropdown-toggle" type="button" id="lr1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="material-icons">more_vert</i></button><div id="rightDropdownMenuApp" class="dropdown-menu dropdown-menu-right" aria-labelledby="lr1"><div id="changeViewType"></div><button id="btnDialogAddChannel" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAddChannel"><i class="material-icons tgv-icon-dropdown">add</i> Add channel</button><div id="deleteChannel"></div><button id="btnDialogSettings" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogSettings"><i class="material-icons tgv-icon-dropdown">settings</i> Settings</button><button id="btnDialogAbout" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAbout"><i class="material-icons tgv-icon-dropdown">info</i> About</button><div class="dropdown-divider"> </div><button id="btnExit" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">exit_to_app</i> Exit</button></div></div>'),renderViewType(),toggleDeleteChannel(),$("#btnDialogAddChannel").click(function(e){renderDialogAddChannel(),my_ga("send","event","renderDialogAddChannel","click","btnDialogAddChannel")}),$("#btnDialogSettings").click(function(e){renderDialogSettings(),my_ga("send","event","renderDialogSettings","click","btnDialogSettings")}),$("#btnDialogAbout").click(function(e){renderDialogAbout(),my_ga("send","event","renderDialogAbout","click","btnDialogAbout")}),$("#btnExit").click(function(e){try{window.opener="_self",window.close(),my_ga("send","event","window_close","click","btnExit")}catch(e){my_ga("send","event","window_close","Error",e)}})}function processScreenResizing(){setMenuHeight(),renderRightMenuApp()}function getFixClass(){return navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?(my_ga("send","event","getFixClass","ios","platform: "+navigator.platform),"tgv-menu-app-ios"):/Edge\/\d./i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","edge","userAgent: "+navigator.userAgent),"tgv-menu-app-edge"):/rv:11.0/i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","ie11","userAgent: "+navigator.userAgent),"tgv-menu-app-ie11"):/MSIE 10/i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","ie10","userAgent: "+navigator.userAgent),"tgv-menu-app-ie10"):/MSIE 9/i.test(navigator.userAgent)||/MSIE/i.test(navigator.userAgent)?(isOldBrowser=!0,my_ga("send","event","getFixClass","ie9-and-oldies","userAgent: "+navigator.userAgent),"tgv-menu-app-ie9-and-oldies"):(my_ga("send","event","getFixClass","other","userAgent: "+navigator.userAgent),"tgv-menu-app")}function preRenderPage(){var e="",a=getFixClass();if(isOldBrowser){var n='<a href="https://www.google.com/chrome/" target="_blank" title="'+navigator.userAgent+'">Your browser is out of date</a>';return e='<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;"><h4>'+App.name+'</h4><br/><img class="img-fluid rounded" src="ico/android-chrome-192x192.png" width="120" height="120" alt="'+App.name+'"><br/><br/><p>Telegram public channel viewer</p><p>'+n+"</p>"+getTextSocial()+"<div>",void $("#app").html(e)}e='<header><nav class="tgv-navbar navbar fixed-top navbar-light bg-light"><a class="navbar-brand" href=""><div class="tgv-dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><div id="menuApp" class="'+a+'"><i class="material-icons">menu</i></div><div id="logoApp"></div></div><div id="dropdownMenuChannel" class="dropdown-menu"><div id="listChannel"></div></div></a><div id="rightMenuApp" class="form-inline"></div></nav></header><div id="modalDialog"></div><div id="mainPage"><center><main id="main" role="main" class="container-fluid tgv-with-header"></main></center></div><footer><div class="fixed-bottom tgv-pagination-footer"><div class="range-message">',$.isEmptyObject(App.currentChannel)?e+='<input type="range" name="rangeMessage" id="rangeMessage" min="1" max="6" step="1" value="1">':e+='<input type="range" name="rangeMessage" id="rangeMessage" min="'+App.currentChannel.min+'" max="'+App.currentChannel.max+'" step="'+App.step+'" value="'+App.currentChannel.value+'">',e+='</div><div class="tgv-pagination-nav"><nav class="tgv-pagination"><button id="btnRandomPageFooter" type="button" class="btn bmd-btn-icon" title="Random"><i class="material-icons">arrow_upward</i></button><button id="btnPrevPageFooter" type="button" class="btn bmd-btn-icon" title="Previous"><i class="material-icons">arrow_back</i></button><button id="btnNextPageFooter" type="button" class="btn bmd-btn-icon" title="Next"><i class="material-icons">arrow_forward</i></button></nav></div></div></footer>',$("#app").html(e),renderLogoApp("#logoApp"),renderListChannel(),renderRightMenuApp(),$(".navbar-brand").click(function(e){e.preventDefault(),setMenuHeight()}),$("#btnRandomPageFooter").click(function(e){getRandomPage(),my_ga("send","event","getRandomPage","click","btnRandomPageFooter")}),$("#btnPrevPageFooter").click(function(e){getPrevPage(),my_ga("send","event","getPrevPage","click","btnPrevPageFooter")}),$("#btnNextPageFooter").click(function(e){getNextPage(),my_ga("send","event","getNextPage","click","btnNextPageFooter")}),$(document).on("input","#rangeMessage",function(e){e.preventDefault(),getStartMessage()}),$(document).on("change","#rangeMessage",function(e){e.preventDefault(),getPage()})}function getPage(){if(!isOldBrowser){if($.isEmptyObject(App.currentChannel)){renderCatalogFrame(),$("body").bootstrapMaterialDesign(),document.title=""+App.name;r=""+location.pathname;history.replaceState(null,null,r)}else{App.currentChannel.lastView=getCurrentDateValue(),App.currentChannel.value<App.currentChannel.min&&(App.currentChannel.value=App.currentChannel.min),App.currentChannel.value>App.currentChannel.max-App.step&&(App.currentChannel.max=App.currentChannel.value+App.step);var e=[],a="";a+='<div class="posts">',a+='<ol class="nav justify-content-center">';for(var n=0;n<App.step;n++){var t="tg://resolve?domain="+App.currentChannel.name+"&post="+(App.currentChannel.value+n),l=App.currentChannel.name+"/"+(App.currentChannel.value+n),i=l.replace("/","-");e.push(i),a+='<li class="post-item '+("list"==App.viewType?"view-list":"view-table")+'">',a+='<div class="post-telegram-url"><a href="'+t+'">'+l+"</a></div>",a+='<div class="post">',App.useProxy?a+='<script async src="js/telegram-widget.js" data-telegram-post="'+l+'" data-width="100%"><\/script>':a+='<script async src="https://telegram.org/js/telegram-widget.js" data-telegram-post="'+l+'" data-width="100%"><\/script>',a+="</div>",a+="</li>"}a+="</ol>",a+="</div>",a+='<div class="posts-footer"></div>',$("#main").html(a),$("#main").addClass("container-fluid"),setRangeMessage(),$(".tgv-pagination-footer").show(),$("body").bootstrapMaterialDesign(),document.title=App.currentChannel.name+" - "+App.currentChannel.value+" - "+App.name;var r=location.pathname+"?channel="+App.currentChannel.name+"&post="+App.currentChannel.value;history.replaceState(null,null,r)}setAppCashe()}}function parseUrlQuery(){var e={};if(window.location.search)for(var a=window.location.search.substr(1).split("&"),n=0;n<a.length;n++)try{var t=a[n].split("=");e[t[0].toLowerCase()]=t[1].toLowerCase()}catch(e){my_ga("send","event","parseUrlQuery","Error parse: "+window.location.search,e)}return e}function addOnWheel(e,a){e.addEventListener&&("onwheel"in document?e.addEventListener("wheel",a):"onmousewheel"in document?e.addEventListener("mousewheel",a):e.addEventListener("MozMousePixelScroll",a))}function setMenuHeight(){var e=260;try{e=window.innerHeight-60}catch(e){my_ga("send","event","setMenuHeight","Error",e)}$("#dropdownMenuChannel").css("max-height",e)}function setAppCashe(){try{var e=localStorage.getItem("App"),a=JSON.stringify(App);e!==a&&localStorage.setItem("App",a)}catch(e){my_ga("send","event","setAppCashe","Error",e)}}function getAppCashe(){try{var e=localStorage.getItem("App");null!=e&&(App=JSON.parse(e))}catch(e){my_ga("send","event","getAppCashe","Error",e)}}function my_ga(e,a,n,t,l){try{ga(e,a,n,t,l)}catch(l){}}function document_ready(){getAppCashe(),""!=window.location.search&&getCurrentChannelSearch(parseUrlQuery()),preRenderPage(),getPage();var t=void 0,l=void 0;try{document.addEventListener("touchstart",function(e){"posts-footer"==e.target.className&&(t=e.changedTouches[0])})}catch(e){my_ga("send","event","addEventListener","Error-touchstart",e)}try{document.addEventListener("touchend",function(e){if("posts-footer"==e.target.className){l=e.changedTouches[0];var a=Math.abs(t.pageX-l.pageX),n=Math.abs(t.pageY-l.pageY);(20<a||20<n)&&(n<a?l.pageX<t.pageX?(getNextPage(),my_ga("send","event","getNextPage","touchend","document")):(getPrevPage(),my_ga("send","event","getPrevPage","touchend","document")):(l.pageY,t.pageY))}})}catch(e){my_ga("send","event","addEventListener","Error-touchend",e)}try{addOnWheel(document,function(e){"posts-footer"==e.target.className&&(0<(e.deltaY||e.detail||e.wheelDelta)?(getNextPage(),my_ga("send","event","getNextPage","wheel","document")):(getPrevPage(),my_ga("send","event","getPrevPage","wheel","document")),e.preventDefault())})}catch(e){my_ga("send","event","addOnWheel","Error-wheel",e)}}$(document).ready(function(){document_ready()}),$(document).keydown(function(e){""==e.target.className&&(37==e.which&&(getPrevPage(),my_ga("send","event","getPrevPage","keydown","document")),36==e.which&&(getRandomPage(),my_ga("send","event","getRandomPage","keydown","document")),39==e.which&&(getNextPage(),my_ga("send","event","getNextPage","keydown","document")))}),$(window).resize(function(){processScreenResizing(),my_ga("send","event","processScreenResizing","resize","window: ("+$(window).width()+"x"+$(window).height()+")")}),$(window).on("popstate",function(e){document_ready(),my_ga("send","event","document_ready","popstate","window: "+location.href)});
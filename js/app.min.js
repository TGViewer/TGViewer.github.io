function getRandomIndex(e,a){return Math.floor(e+Math.random()*(a+1-e))}function getRandomMessage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=getRandomIndex(App.currentChannel.min,App.currentChannel.max))}function getStartMessage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=getNumberValue($("#rangeMessage").val()))}function setRangeMessage(){if(!$.isEmptyObject(App.currentChannel)){var e=$("#rangeMessage")[0];e.step=App.step,e.min=App.currentChannel.min,e.max=App.currentChannel.max,e.value=App.currentChannel.value}}function searchElementIndexInArray(e,a,n){for(var t=-1,l=e,i=0;i<l.length;i++){var r=l[i];if(r.hasOwnProperty(n)&&r[n].toLowerCase()===a.toLowerCase())return t=i}return t}function imgLoaded(e){$(e).parent().addClass("loaded")}function lazyLoad(){var e=$(".lazy_load");e.each(function(){var e=$(this);""!=e.attr("data-src")&&e.on("load",imgLoaded(e[0])).attr("src",e.attr("data-src")).attr("data-src","")})}function renderLogoApp(e){if($.isEmptyObject(App.currentChannel)){var a=App.name;$(e).html('<img class="d-inline-block align-top rounded-circle" src="ico/favicon-32x32.png" width="32" height="32" title="'+a+'" alt="'+a+'"><span class="logo-app">'+a+"</span>")}else if(""!=App.currentChannel.image){var n=App.currentChannel.title||App.currentChannel.name;$(e).html('<img class="d-inline-block align-top rounded-circle tgv-empty-image" src="'+App.currentChannel.image+'" width="32" height="32" title="'+n+'" alt="" onload="this.alt=\''+n+'\';"><span class="logo-app">'+n+"</span>")}else{var t=App.currentChannel.name;$(e).html('<span class="letter-circle" title="'+t+'">'+t.substr(0,2).toUpperCase()+'</span><span class="logo-app">'+t+"</span>")}}function renderCatalogFrame(){getAppCashe(),void 0===App.currentCatalogPage&&(arrayCatalogChannel.length>0&&(maxPageNumber=Math.ceil(arrayCatalogChannel.length/12)),App.currentCatalogPage=getRandomIndex(1,maxPageNumber),setAppCashe());var e='<iframe class="tgv-catalog-frame" src="https://tgviewer.github.io/channel/page/'+App.currentCatalogPage+'" onload="this.style.opacity=1;" style="opacity:0;"></iframe>';$("#main").html(e),$("#main").removeClass("container-fluid"),$(".tgv-pagination-footer").hide(),$("#changeViewType").hide(),$("#deleteChannel").html(""),App.currentChannel={},renderLogoApp("#logoApp")}function addEventForBtnSelectChannel(){$("#btnSelectChannel").click(function(){renderCatalogFrame()})}function renderListChannel(){if(App.channels.length>0){var e="";e+='<h6 id="btnSelectChannel" class="dropdown-header">Select channel</h6>';for(var a=0;a<App.channels.length;a++){var n=App.channels[a].name,t=App.channels[a].title||n,l=App.channels[a].image;e+=""!=l?'<button class="dropdown-item list-channel-item" type="button"><img class="d-inline-block align-top rounded-circle logo-channel-img channel-item tgv-empty-image lazy_load" src="" data-src="'+l+'" width="32" height="32" data-name="'+n+'" title="'+t+'" alt="" onload="this.alt=\''+t+'\';"><span class="name-channel">'+t+"</span></button>":'<button class="dropdown-item list-channel-item" type="button"><span class="letter-circle logo-channel channel-item" data-name="'+n+'" title="'+n+'">'+n.substr(0,2).toUpperCase()+'</span><span class="name-channel">'+n+"</span></button>"}if($("#listChannel").html(e),addEventForBtnSelectChannel(),""!=e){lazyLoad();var i=$(".list-channel-item");i.click(function(){var e=$(this).find(".channel-item").attr("data-name");App.currentChannel=App.channels[searchElementIndexInArray(App.channels,e,"name")];var a=App.currentChannel;try{""!=a.image&&""!=a.title&&0!=a.lastUpdate||getCurrentChannelInfo(a.name)}catch(n){my_ga("send","event","selectChannel: "+e,"error","getCurrentChannelInfo")}renderLogoApp("#logoApp"),renderViewType(),toggleDeleteChannel(),getPage(),my_ga("send","event","selectChannel: "+e,"click","listChannelItem")})}}else $("#listChannel").html('<h6 id="btnSelectChannel" class="dropdown-header">Add channels to select</h6>'),addEventForBtnSelectChannel();toggleDeleteChannel()}function toggleDeleteChannel(){if($.isEmptyObject(App.currentChannel))$("#deleteChannel").html("");else{var e=$(window).width();e>420?$("#deleteChannel").html('<button id="btnDeleteChannel" type="button" class="btn bmd-btn-icon" title="Delete current channel"><i class="material-icons">delete</i></button>'):$("#deleteChannel").html('<button id="btnDeleteChannel" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">delete</i> Delete channel</button>'),$("#btnDeleteChannel").click(function(){deleteCurrentChannel(),my_ga("send","event","deleteCurrentChannel","click","btnDeleteChannel")})}}function renderViewType(){var e=$(window).width();e>420?"list"==App.viewType?$("#changeViewType").html('<button id="btnViewType" type="button" class="btn bmd-btn-icon" title="Table view"><i class="material-icons">view_module</i></button>'):$("#changeViewType").html('<button id="btnViewType" type="button" class="btn bmd-btn-icon" title="List view"><i class="material-icons">view_list</i></button>'):"list"==App.viewType?$("#changeViewType").html('<button id="btnViewType" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">view_module</i> Table view</button><div id="btnViewTypeDivider" class="dropdown-divider"> </div>'):$("#changeViewType").html('<button id="btnViewType" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">view_list</i> List view</button><div id="btnViewTypeDivider" class="dropdown-divider"> </div>'),$("#btnViewType").click(function(){toggleViewType(),my_ga("send","event","toggleViewType: "+App.viewType,"click","btnViewType")}),$.isEmptyObject(App.currentChannel)?$("#changeViewType").hide():$("#changeViewType").show()}function toggleViewType(){App.viewType="list"==App.viewType?"table":"list",renderViewType(),getPage()}function deleteCurrentChannel(){$.isEmptyObject(App.currentChannel)||App.channels.length>0&&(App.channels.splice(searchElementIndexInArray(App.channels,App.currentChannel.name,"name"),1),App.currentChannel={},renderLogoApp("#logoApp"),renderListChannel(),setAppCashe(),getPage())}function getCurrentChannelSettings_ArrayCatalogChannel(e,a,n){a=a||1,n=n||!1;for(var t=0;t<arrayCatalogChannel.length;t++){var l=arrayCatalogChannel[t],i=l.name,r=searchElementIndexInArray(App.channels,i,"name");if(-1!=r){var o=App.channels[r];o.name=i,o.title=l.title,o.image=l.image,o.min=l.minMessage,o.max=l.maxMessage,o.value<o.min&&(o.value=o.min),i.toLowerCase()==e.toLowerCase()&&(App.currentChannel=o,n?App.currentChannel.max>30&&getRandomMessage():(App.currentChannel.value=a,App.currentChannel.value<App.currentChannel.min&&(App.currentChannel.value=App.currentChannel.min)))}}renderLogoApp("#logoApp"),renderListChannel(),setAppCashe(),getPage(),my_ga("send","event","getCurrentChannelSettings: "+e,"function","getCurrentChannelSearch")}function getCurrentChannelSettings(e,a,n){arrayCatalogChannel.length>0?getCurrentChannelSettings_ArrayCatalogChannel(e,a,n):$.getJSON("data/catalog.json").done(function(t){arrayCatalogChannel=t,getCurrentChannelSettings_ArrayCatalogChannel(e,a,n)})}function addCurrentChannelSettings(e,a,n){var t=e,l=1,i=l+App.step;a=a||1,n=n||!1,a>1?i=a+App.step:a=l,l=l>i?i:l,i=l>i?l:i,a=l>a?l:a,a=a>i?i:a;var r={name:t,min:l,max:i,value:a,title:"",image:"",description:"",descriptionHtml:"",members:0,lastUpdate:0,lastView:0};n?App.channels.push(r):(App.currentChannel=r,App.channels.push(App.currentChannel),getCurrentChannelInfo(App.currentChannel.name))}function p(e,a){e.push(a)}function getCurrentChannelInfo(e){var a=[];p(a,"h"),p(a,"t"),p(a,"t"),p(a,"p"),p(a,"s"),p(a,":"),p(a,"/"),p(a,"/"),p(a,"s"),p(a,"c"),p(a,"r"),p(a,"i"),p(a,"p"),p(a,"t"),p(a,"."),p(a,"g"),p(a,"o"),p(a,"o"),p(a,"g"),p(a,"l"),p(a,"e"),p(a,"."),p(a,"c"),p(a,"o"),p(a,"m"),p(a,"/"),p(a,"m"),p(a,"a"),p(a,"c"),p(a,"r"),p(a,"o"),p(a,"s"),p(a,"/"),p(a,"s"),p(a,"/"),p(a,"A"),p(a,"K"),p(a,"f"),p(a,"y"),p(a,"c"),p(a,"b"),p(a,"x"),p(a,"c"),p(a,"B"),p(a,"Y"),p(a,"e"),p(a,"E"),p(a,"9"),p(a,"E"),p(a,"q"),p(a,"s"),p(a,"9"),p(a,"d"),p(a,"q"),p(a,"p"),p(a,"S"),p(a,"e"),p(a,"B"),p(a,"r"),p(a,"b"),p(a,"4"),p(a,"R"),p(a,"e"),p(a,"2"),p(a,"q"),p(a,"3"),p(a,"w"),p(a,"T"),p(a,"j"),p(a,"o"),p(a,"f"),p(a,"q"),p(a,"1"),p(a,"5"),p(a,"_"),p(a,"b"),p(a,"w"),p(a,"V"),p(a,"i"),p(a,"s"),p(a,"Z"),p(a,"_"),p(a,"4"),p(a,"C"),p(a,"n"),p(a,"5"),p(a,"d"),p(a,"h"),p(a,"j"),p(a,"4"),p(a,"/"),p(a,"e"),p(a,"x"),p(a,"e"),p(a,"c"),p(a,"?"),p(a,"c"),p(a,"h"),p(a,"a"),p(a,"n"),p(a,"n"),p(a,"e"),p(a,"l"),p(a,"=");var n=""+a.join("")+e;$.ajax({url:n,success:function(a){a.result&&(App.currentChannel.title=a.title||e,App.currentChannel.image=a.image,App.currentChannel.description=a.description,App.currentChannel.descriptionHtml=a.descriptionHtml,App.currentChannel.members=a.members,App.currentChannel.lastUpdate=getCurrentDateValue(),renderLogoApp("#logoApp"),renderListChannel(),renderViewType(),setAppCashe(),my_ga("send","event","getCurrentChannelInfo: "+e,"function","addCurrentChannelSettings"))}})}function getCurrentDateValue(){var e=new Date;return e.valueOf()}function getDateWithValue(e){return new Date(e)}function getSanitizeCurrentChannelParameters(e){var a={},n=1,t="";t=$("<div/>").html(e).text().replace("tg://resolve?domain=","").split("&",1),t=$("<div/>").html(t).text().replace("http://","").replace("https://","").replace(domainOriginal,"").replace(domainSecond,"").replace("tglink.ru/","").replace("telegram.me/","");var l=t.split("/",2);return t=l[0],l.length>1&&(n=getNumberValue(l[1])),t=$("<div/>").html(t).text().replace(/<script>/gi,"").replace(/<script /gi,"").replace(/<\/script>/gi,"").replace(/javascript:/gi,"").replace(/["'`!@#%&=:;, .*+?^${}()|[\]\\\/]/g,"").trim(),a.name=t,a.value=n,a}function getSanitizeValue(e){var a="";return a=$("<div/>").html(e).text().replace("tg://resolve?domain=","").split("&",1),a=$("<div/>").html(a).text().replace("http://","").replace("https://","").replace(domainOriginal,"").replace(domainSecond,"").replace("tglink.ru/","").replace("telegram.me/","").split("/",1),a=$("<div/>").html(a).text().replace(/<script>/gi,"").replace(/<script /gi,"").replace(/<\/script>/gi,"").replace(/javascript:/gi,"").replace(/["'`!@#%&=:;, .*+?^${}()|[\]\\\/]/g,"").trim()}function getBooleanValue(e){var a=!1;return"boolean"==typeof e?a=e:e.toLowerCase()==="true".toLowerCase()&&(a=!0),a}function getNumberValue(e){var a=parseInt(e,10);return isNaN(a)&&(a=1),1>a&&(a=1),a}function getCurrentChannelSearch(e){if(!$.isEmptyObject(e)){var a=!0,n=1;if(e.hasOwnProperty("search")){var t=getSanitizeCurrentChannelParameters(e.search),l=t.name;if(n=t.value,n>1&&(a=!1),""!=l){var i=searchElementIndexInArray(App.channels,l,"name");-1==i?addCurrentChannelSettings(l,n):(App.currentChannel=App.channels[i],n>1&&(App.currentChannel.value=n))}}else if(e.hasOwnProperty("channel")){var r=getSanitizeValue(e.channel);if(""!=r){var i=searchElementIndexInArray(App.channels,r,"name");-1==i?addCurrentChannelSettings(r,n):App.currentChannel=App.channels[i]}}else if(e.hasOwnProperty("channels")){e.channels=e.channels||"";for(var o=e.channels.split(";"),s=0;s<o.length;s++){var p=o[s],t=getSanitizeCurrentChannelParameters(p),l=t.name;if(n=t.value,a=1>=n,""!=l){var i=searchElementIndexInArray(App.channels,l,"name");-1==i?0==s?addCurrentChannelSettings(l,n):addCurrentChannelSettings(l,n,!0):0==s&&(App.currentChannel=App.channels[i],n>1&&(App.currentChannel.value=n))}}}if(e.hasOwnProperty("proxy")&&(App.useProxy=getBooleanValue(e.proxy)),e.hasOwnProperty("view")&&(App.viewType=getSanitizeValue(e.view)),e.hasOwnProperty("step")){var d=getNumberValue(getSanitizeValue(e.step));d=1>d?1:d,d=d>30?30:d,App.step=d}$.isEmptyObject(App.currentChannel)||(e.hasOwnProperty("min")&&(App.currentChannel.min=getNumberValue(getSanitizeValue(e.min))),e.hasOwnProperty("max")&&(App.currentChannel.max=getNumberValue(getSanitizeValue(e.max))),e.hasOwnProperty("post")&&(App.currentChannel.value=getNumberValue(getSanitizeValue(e.post)),a=!1),getCurrentChannelSettings(App.currentChannel.name,App.currentChannel.value,a))}}function getCurrentChannelAdd(){var e=$("#searchChannel"),a=getSanitizeCurrentChannelParameters(e.val()),n=a.name,t=a.value;if(""!=n){var l=searchElementIndexInArray(App.channels,n,"name");if(-1==l){var i=1>=t;addCurrentChannelSettings(n,t),getCurrentChannelSettings(n,t,i)}else App.currentChannel=App.channels[l],t>1&&(App.currentChannel.value=t);e.val(""),n="",renderLogoApp("#logoApp"),renderListChannel(),getPage()}}function getRandomPage(){getRandomMessage(),getPage()}function getPrevPage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=App.currentChannel.value-App.step,getPage())}function getNextPage(){$.isEmptyObject(App.currentChannel)||(App.currentChannel.value=App.currentChannel.value+App.step,getPage())}function getTextSocial(){return'<hr class="tgv-social-hr"><ul class="nav justify-content-center"><li class="nav-item tgv-social"><a target="_blank" href="https://twitter.com/TGViewer/" class="nav-link"><img class="tgv-icon" src="ico/social-twitter.png" title="Twitter" alt="Twitter" width="24" height="24"></a></li><li class="nav-item tgv-social"><a target="_blank" href="https://www.instagram.com/TGViewer/" class="nav-link"><img class="tgv-icon" src="ico/social-instagram.png" title="Instagram" alt="Instagram" width="24" height="24"></a></li></ul>'}function getTextExampleChannel(){var e=[];e.push("Telegram"),e.push("TechHype"),e.push("TricksInfo"),e.push("HotVibes"),e.push("BestMemes"),e.push("SuperDeals");for(var a="",n=0;n<e.length;n++)a+='<a href="" class="btnAddChannel badge badge-pill badge-light">'+e[n]+"</a> ";return a}function getTextSearchChannel(){return'<span><input name="searchChannel" list="searchListChannel" id="searchChannel" class="form-control" type="text" id="search" placeholder="Enter telegram public channel name..." title="Enter telegram public channel name (or paste post url)"><datalist id="searchListChannel"></datalist><small class="text-muted" title="Example: Telegram or Telegram/88 or https://'+domainOriginal+'Telegram/88">Example: '+getTextExampleChannel()+' etc.</small></span><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogAddChannelSave" type="button" class="btn btn-primary" data-dismiss="modal">Add channel</button></div>'}function getSearchListChannel_ArrayCatalogChannel(){for(var e="",a=0;a<arrayCatalogChannel.length;a++){var n=arrayCatalogChannel[a],t=n.name,l=n.title;e+='<option value="'+t+'">'+t+": "+l+"</option>"}""!=e&&$("#searchListChannel").html(e)}function getSearchListChannel(){arrayCatalogChannel.length>0?getSearchListChannel_ArrayCatalogChannel():$.getJSON("data/catalog.json").done(function(e){arrayCatalogChannel=e,getSearchListChannel_ArrayCatalogChannel()})}function renderDialogAddChannel(){var e='<div class="modal fade" id="modalDialogAddChannel" tabindex="-1" role="dialog" aria-labelledby="modalDialogAddChannelLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogAddChannelLabel">Add channel</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body">';e+='<ul class="nav nav-tabs" id="myTab" role="tablist"><li class="nav-item"><a class="nav-link active" id="add-tab" data-toggle="tab" href="#add" role="tab" aria-controls="add" aria-selected="true">Add</a></li><li class="nav-item"><a class="nav-link" id="search-tab" data-toggle="tab" href="#search" role="tab" aria-controls="search" aria-selected="false">Search</a></li></ul><div class="tab-content" id="myTabContent"><div class="tab-pane fade show active" id="add" role="tabpanel" aria-labelledby="add-tab">'+getTextSearchChannel()+'</div><div class="tab-pane fade" id="search" role="tabpanel" aria-labelledby="search-tab"><div id="catalogChannel"><iframe src="search.html" style="width:100%; height:444px; border:none;"></iframe></div></div></div>',e+="</div></div></div></div>",$("#modalDialog").html(e),getSearchListChannel();var a=$("#searchChannel"),n=$(".btnAddChannel");n.click(function(e){var t=$(this).text();e.preventDefault(),e.stopPropagation(),a.val(t),n.blur(),my_ga("send","event","searchChannel: "+t,"click","btnAddChannel")}),$("#modalDialogAddChannel").on("shown.bs.modal",function(){a.trigger("focus"),a.select()}),$("#modalDialogAddChannel").on("hidden.bs.modal",function(){$("#modalDialog").html("")}),$("#btnDialogAddChannelSave").click(function(){getCurrentChannelAdd(),my_ga("send","event","getCurrentChannelAdd","click","btnDialogAddChannelSave")})}function getTextSettings(){var e="";if(e+='<div class="container"><br><div id="logoAppDialog"></div><div><div class="form-group"><label for="appStep" class="bmd-label-floating">Step messages</label><input type="number" class="form-control" id="appStep" name="appStep" min="1" max="30" step="1" value="'+App.step+'"><span class="bmd-help">App step messages</span></div><div class="form-group" title="If your ISP blocks access to the Telegram servers, use the &proxy=true parameter in url (disable &proxy=false)">',e+=renderModalDialogSettingsBMD?'<div class="switch"><label><input type="checkbox" id="appUseProxy"'+(App.useProxy?" checked":"")+'><span class="bmd-switch-track"><div class="ripple-container"></div></span> Use proxy</label></div>':'<div class="switch"><label><input type="checkbox" id="appUseProxy"'+(App.useProxy?" checked":"")+"> Use proxy</label></div>",e+="</div></div>",!$.isEmptyObject(App.currentChannel)){var a=App.currentChannel.name;""!=App.currentChannel.image&&(a=App.currentChannel.title||a),e+='<div><div class="form-group"><label for="currentChannelMin" class="bmd-label-floating">Min message</label><input type="number" class="form-control" id="currentChannelMin" name="currentChannelMin" min="1" value="'+App.currentChannel.min+'"><span class="bmd-help"><b>'+a+'</b> channel min message</span></div><div class="form-group"><label for="currentChannelMax" class="bmd-label-floating">Max message</label><input type="number" class="form-control" id="currentChannelMax" name="currentChannelMax" min="1" value="'+App.currentChannel.max+'"><span class="bmd-help"><b>'+a+'</b> channel max message</span></div><div class="form-group"><label for="currentChannelValue" class="bmd-label-floating">Current message</label><input type="number" class="form-control" id="currentChannelValue" name="currentChannelValue" min="1" value="'+App.currentChannel.value+'"><span class="bmd-help"><b>'+a+"</b> channel current message</span></div></div>"}return e+='<br><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogSettingsSave" type="button" class="btn btn-primary" data-dismiss="modal">Save settings</button></div></div>'}function getTextChannelInfo(){var e="",a=App.currentChannel;if(!$.isEmptyObject(a)&&""!=a.image){var n=a.name,t=a.title||n;e+='<div class="container"><br><a href="tg://resolve?domain='+n+'"><img class="card-img-top img-fluid rounded-circle mx-auto d-block tgv-empty-image" src="'+a.image+'" title="'+t+'" alt="" onload="this.alt=\''+t+'\';"></a><div class="card-body"><h5 class="card-title">'+t+'</h5><h6 class="card-subtitle mb-2 text-muted"><a href="https://'+domainOriginal+n+'" target="_blank">'+domainOriginal+n+"</a></h6>",a.members>0&&(e+='<p class="card-text"><small class="text-muted">'+a.members+" members</small></p>"),e+='<p class="card-text">'+a.descriptionHtml+"</p></div>",e+='<br><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><button id="btnDialogUpdateInfo" type="button" class="btn btn-primary" data-dismiss="modal">Update info</button></div></div>'}return e}function renderDialogSettings(){var e='<div class="modal fade" id="modalDialogSettings" tabindex="-1" role="dialog" aria-labelledby="modalDialogSettingsLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogSettingsLabel">Settings</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body">',a='style="display: none;"';$.isEmptyObject(App.currentChannel)||""!=App.currentChannel.image&&(a=""),e+='<ul class="nav nav-tabs" id="myTab" role="tablist" '+a+'><li class="nav-item"><a class="nav-link active" id="settings-tab" data-toggle="tab" href="#settings" role="tab" aria-controls="settings" aria-selected="true">Settings</a></li><li class="nav-item"><a class="nav-link" id="info-tab" data-toggle="tab" href="#info" role="tab" aria-controls="info" aria-selected="false">Channel info</a></li></ul><div class="tab-content" id="myTabContent"><div class="tab-pane fade show active" id="settings" role="tabpanel" aria-labelledby="settings-tab">'+getTextSettings()+'</div><div class="tab-pane fade" id="info" role="tabpanel" aria-labelledby="info-tab">'+getTextChannelInfo()+"</div></div>",e+="</div></div></div></div>",$("#modalDialog").html(e),$("#appUseProxy")[0].checked=App.useProxy||!1,renderLogoApp("#logoAppDialog"),renderModalDialogSettingsBMD||($("#modalDialog").bootstrapMaterialDesign(),renderModalDialogSettingsBMD=!0),$("#modalDialogSettings").on("shown.bs.modal",function(){$("#appStep").trigger("focus"),$("#appStep").select()}),$("#modalDialogSettings").on("hidden.bs.modal",function(){$("#modalDialog").html("")}),$("#btnDialogSettingsSave").click(function(){var e=$("#appUseProxy")[0].checked;App.useProxy=e||!1;var a=getNumberValue($("#appStep").val());if(a=1>a?1:a,a=a>30?30:a,App.step=a,!$.isEmptyObject(App.currentChannel)){var n=getNumberValue($("#currentChannelMin").val()),t=getNumberValue($("#currentChannelMax").val()),l=getNumberValue($("#currentChannelValue").val());n=n>t?t:n,t=n>t?n:t,l=n>l?n:l,l=l>t?t:l,App.currentChannel.min=n,App.currentChannel.max=t,App.currentChannel.value=l,getPage()}setAppCashe(),my_ga("send","event","renderDialogSettingsSave","click","btnDialogSettingsSave")}),$("#btnDialogUpdateInfo").click(function(){$.isEmptyObject(App.currentChannel)||getCurrentChannelInfo(App.currentChannel.name),my_ga("send","event","renderDialogSettingsSave","click","btnDialogUpdateInfo")})}function renderDialogAbout(){var e='<div class="modal fade" id="modalDialogAbout" tabindex="-1" role="dialog" aria-labelledby="modalDialogAboutLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modalDialogAboutLabel">About</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><center><h4>'+App.name+'</h4><br/><img class="img-fluid rounded" src="ico/android-chrome-192x192.png" width="120" height="120" alt="'+App.name+'"><br/><br/><p>Telegram public channel viewer</p>'+getTextSocial()+'</center></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button></div></div></div></div>';$("#modalDialog").html(e),$("#modalDialogAbout").on("hidden.bs.modal",function(){$("#modalDialog").html("")})}function renderRightMenuApp(){var e=$(window).width();e>420?$("#rightMenuApp").html('<div id="changeViewType"></div><button id="btnDialogAddChannel" type="button" class="btn bmd-btn-icon" data-toggle="modal" data-target="#modalDialogAddChannel" title="Add new channel"><i class="material-icons">add</i></button><div id="deleteChannel"></div><div class="dropdown pull-xs-right"><button class="btn bmd-btn-icon dropdown-toggle" type="button" id="lr1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="material-icons">more_vert</i></button><div id="rightDropdownMenuApp" class="dropdown-menu dropdown-menu-right" aria-labelledby="lr1"><button id="btnDialogSettings" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogSettings"><i class="material-icons tgv-icon-dropdown">settings</i> Settings</button><button id="btnDialogAbout" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAbout"><i class="material-icons tgv-icon-dropdown">info</i> About</button><div class="dropdown-divider"> </div><button id="btnExit" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">exit_to_app</i> Exit</button></div></div>'):$("#rightMenuApp").html('<div class="dropdown pull-xs-right"><button class="btn bmd-btn-icon dropdown-toggle" type="button" id="lr1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="material-icons">more_vert</i></button><div id="rightDropdownMenuApp" class="dropdown-menu dropdown-menu-right" aria-labelledby="lr1"><div id="changeViewType"></div><button id="btnDialogAddChannel" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAddChannel"><i class="material-icons tgv-icon-dropdown">add</i> Add channel</button><div id="deleteChannel"></div><button id="btnDialogSettings" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogSettings"><i class="material-icons tgv-icon-dropdown">settings</i> Settings</button><button id="btnDialogAbout" type="button" class="dropdown-item" data-toggle="modal" data-target="#modalDialogAbout"><i class="material-icons tgv-icon-dropdown">info</i> About</button><div class="dropdown-divider"> </div><button id="btnExit" type="button" class="dropdown-item"><i class="material-icons tgv-icon-dropdown">exit_to_app</i> Exit</button></div></div>'),renderViewType(),toggleDeleteChannel(),$("#btnDialogAddChannel").click(function(){renderDialogAddChannel(),my_ga("send","event","renderDialogAddChannel","click","btnDialogAddChannel")}),$("#btnDialogSettings").click(function(){renderDialogSettings(),my_ga("send","event","renderDialogSettings","click","btnDialogSettings")}),$("#btnDialogAbout").click(function(){renderDialogAbout(),my_ga("send","event","renderDialogAbout","click","btnDialogAbout")}),$("#btnExit").click(function(){try{window.opener="_self",window.close(),my_ga("send","event","window_close","click","btnExit")}catch(e){my_ga("send","event","window_close","Error",e)}})}function processScreenResizing(){setMenuHeight(),renderRightMenuApp()}function getFixClass(){return navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?(my_ga("send","event","getFixClass","ios","platform: "+navigator.platform),"tgv-menu-app-ios"):/Edge\/\d./i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","edge","userAgent: "+navigator.userAgent),"tgv-menu-app-edge"):/rv:11.0/i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","ie11","userAgent: "+navigator.userAgent),"tgv-menu-app-ie11"):/MSIE 10/i.test(navigator.userAgent)?(my_ga("send","event","getFixClass","ie10","userAgent: "+navigator.userAgent),"tgv-menu-app-ie10"):/MSIE 9/i.test(navigator.userAgent)||/MSIE/i.test(navigator.userAgent)?(isOldBrowser=!0,my_ga("send","event","getFixClass","ie9-and-oldies","userAgent: "+navigator.userAgent),"tgv-menu-app-ie9-and-oldies"):(my_ga("send","event","getFixClass","other","userAgent: "+navigator.userAgent),"tgv-menu-app")}function preRenderPage(){var e="",a=getFixClass();if(isOldBrowser){var n='<a href="https://www.google.com/chrome/" target="_blank" title="'+navigator.userAgent+'">Your browser is out of date</a>';return e='<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;"><h4>'+App.name+'</h4><br/><img class="img-fluid rounded" src="ico/android-chrome-192x192.png" width="120" height="120" alt="'+App.name+'"><br/><br/><p>Telegram public channel viewer</p><p>'+n+"</p>"+getTextSocial()+"<div>",void $("#app").html(e)}e='<header><nav class="tgv-navbar navbar fixed-top navbar-light bg-light"><a class="navbar-brand" href=""><div class="tgv-dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><div id="menuApp" class="'+a+'"><i class="material-icons">menu</i></div><div id="logoApp"></div></div><div id="dropdownMenuChannel" class="dropdown-menu"><div id="listChannel"></div></div></a><div id="rightMenuApp" class="form-inline"></div></nav></header><div id="modalDialog"></div><div id="mainPage"><center><main id="main" role="main" class="container-fluid tgv-with-header"></main></center></div><footer><div class="fixed-bottom tgv-pagination-footer"><div class="range-message">',e+=$.isEmptyObject(App.currentChannel)?'<input type="range" name="rangeMessage" id="rangeMessage" min="1" max="6" step="1" value="1">':'<input type="range" name="rangeMessage" id="rangeMessage" min="'+App.currentChannel.min+'" max="'+App.currentChannel.max+'" step="'+App.step+'" value="'+App.currentChannel.value+'">',e+='</div><div class="tgv-pagination-nav"><nav class="tgv-pagination"><button id="btnRandomPageFooter" type="button" class="btn bmd-btn-icon" title="Random"><i class="material-icons">arrow_upward</i></button><button id="btnPrevPageFooter" type="button" class="btn bmd-btn-icon" title="Previous"><i class="material-icons">arrow_back</i></button><button id="btnNextPageFooter" type="button" class="btn bmd-btn-icon" title="Next"><i class="material-icons">arrow_forward</i></button></nav></div></div></footer>',$("#app").html(e),renderLogoApp("#logoApp"),renderListChannel(),renderRightMenuApp(),$(".navbar-brand").click(function(e){e.preventDefault(),setMenuHeight()}),$("#btnRandomPageFooter").click(function(){getRandomPage(),my_ga("send","event","getRandomPage","click","btnRandomPageFooter")}),$("#btnPrevPageFooter").click(function(){getPrevPage(),my_ga("send","event","getPrevPage","click","btnPrevPageFooter")}),$("#btnNextPageFooter").click(function(){getNextPage(),my_ga("send","event","getNextPage","click","btnNextPageFooter")}),$(document).on("input","#rangeMessage",function(e){e.preventDefault(),getStartMessage()}),$(document).on("change","#rangeMessage",function(e){e.preventDefault(),getPage()})}function getPage(){if(!isOldBrowser){if($.isEmptyObject(App.currentChannel)){renderCatalogFrame(),$("body").bootstrapMaterialDesign(),document.title=""+App.name;var e=""+location.pathname;history.replaceState(null,null,e)}else{App.currentChannel.lastView=getCurrentDateValue(),App.currentChannel.value<App.currentChannel.min&&(App.currentChannel.value=App.currentChannel.min),App.currentChannel.value>App.currentChannel.max-App.step&&(App.currentChannel.max=App.currentChannel.value+App.step);var a=[],n="";n+='<div class="posts">',n+='<ol class="nav justify-content-center">';for(var t=0;t<App.step;t++){var l="tg://resolve?domain="+App.currentChannel.name+"&post="+(App.currentChannel.value+t),i=""+App.currentChannel.name+"/"+(App.currentChannel.value+t),r=i.replace("/","-");a.push(r),n+='<li class="post-item '+("list"==App.viewType?"view-list":"view-table")+'">',n+='<div class="post-telegram-url"><a href="'+l+'">'+i+"</a></div>",n+='<div class="post">',n+=App.useProxy?'<script async src="js/telegram-widget.js" data-telegram-post="'+i+'" data-width="100%"></script>':'<script async src="https://telegram.org/js/telegram-widget.js" data-telegram-post="'+i+'" data-width="100%"></script>',n+="</div>",n+="</li>"}n+="</ol>",n+="</div>",n+='<div class="posts-footer"></div>',$("#main").html(n),$("#main").addClass("container-fluid"),setRangeMessage(),$(".tgv-pagination-footer").show(),$("body").bootstrapMaterialDesign(),document.title=""+App.currentChannel.name+" - "+App.currentChannel.value+" - "+App.name;var e=""+location.pathname+"?channel="+App.currentChannel.name+"&post="+App.currentChannel.value;history.replaceState(null,null,e)}setAppCashe()}}function parseUrlQuery(){var e={};if(window.location.search)for(var a=window.location.search.substr(1).split("&"),n=0;n<a.length;n++)try{var t=a[n].split("=");e[t[0].toLowerCase()]=t[1].toLowerCase();
}catch(l){my_ga("send","event","parseUrlQuery","Error parse: "+window.location.search,l)}return e}function addOnWheel(e,a){e.addEventListener&&("onwheel"in document?e.addEventListener("wheel",a):"onmousewheel"in document?e.addEventListener("mousewheel",a):e.addEventListener("MozMousePixelScroll",a))}function setMenuHeight(){var e=260;try{e=window.innerHeight-60}catch(a){my_ga("send","event","setMenuHeight","Error",a)}$("#dropdownMenuChannel").css("max-height",e)}function setAppCashe(){try{var e=localStorage.getItem("App"),a=JSON.stringify(App);e!==a&&localStorage.setItem("App",a)}catch(n){my_ga("send","event","setAppCashe","Error",n)}}function getAppCashe(){try{var e=localStorage.getItem("App");null!=e&&(App=JSON.parse(e))}catch(a){my_ga("send","event","getAppCashe","Error",a)}}function my_ga(e,a,n,t,l){try{ga(e,a,n,t,l)}catch(l){}}function document_ready(){getAppCashe(),""!=window.location.search&&getCurrentChannelSearch(parseUrlQuery()),preRenderPage(),getPage();var e=void 0,a=void 0;try{document.addEventListener("touchstart",function(a){"posts-footer"==a.target.className&&(e=a.changedTouches[0])})}catch(n){my_ga("send","event","addEventListener","Error-touchstart",n)}try{document.addEventListener("touchend",function(n){if("posts-footer"==n.target.className){a=n.changedTouches[0];var t=Math.abs(e.pageX-a.pageX),l=Math.abs(e.pageY-a.pageY);(t>20||l>20)&&(t>l?a.pageX<e.pageX?(getNextPage(),my_ga("send","event","getNextPage","touchend","document")):(getPrevPage(),my_ga("send","event","getPrevPage","touchend","document")):a.pageY<e.pageY)}})}catch(n){my_ga("send","event","addEventListener","Error-touchend",n)}try{addOnWheel(document,function(e){if("posts-footer"==e.target.className){var a=e.deltaY||e.detail||e.wheelDelta;a>0?(getNextPage(),my_ga("send","event","getNextPage","wheel","document")):(getPrevPage(),my_ga("send","event","getPrevPage","wheel","document")),e.preventDefault()}})}catch(n){my_ga("send","event","addOnWheel","Error-wheel",n)}}var App={};App.name="TGViewer",App.useProxy=!1,App.viewType="list",App.step=6,App.channels=[],App.currentChannel={};var renderModalDialogSettingsBMD=!1,isOldBrowser=!1,domainOriginal="t.me/",domainSecond="tele.click/",arrayCatalogChannel=[],maxPageNumber=113;$(document).ready(function(){document_ready()}),$(document).keydown(function(e){""==e.target.className&&(37==e.which&&(getPrevPage(),my_ga("send","event","getPrevPage","keydown","document")),36==e.which&&(getRandomPage(),my_ga("send","event","getRandomPage","keydown","document")),39==e.which&&(getNextPage(),my_ga("send","event","getNextPage","keydown","document")))}),$(window).resize(function(){processScreenResizing(),my_ga("send","event","processScreenResizing","resize","window: ("+$(window).width()+"x"+$(window).height()+")")}),$(window).on("popstate",function(){document_ready(),my_ga("send","event","document_ready","popstate","window: "+location.href)});